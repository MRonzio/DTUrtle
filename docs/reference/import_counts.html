<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Import quantification results — import_counts • DTUrtle</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Import quantification results — import_counts" />
<meta property="og:description" content="Import the quantification results of many RNA-seq quantifiers, including alevin and bustools for single-cell data.
Most likely the first step in your DTUrtle analysis." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DTUrtle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mkin.html">Vignette human bulk RNA-seq</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Import quantification results</h1>
    
    <div class="hidden name"><code>import_counts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Import the quantification results of many RNA-seq quantifiers, including <code>alevin</code> and <code>bustools</code> for single-cell data.
Most likely the first step in your DTUrtle analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>import_counts</span>(<span class='no'>files</span>, <span class='no'>type</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>files</th>
      <td><p>Vector of files to be imported. Optionally can be named to keep the samples names.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of the quantification data. All tools supported by <code><a href='https://rdrr.io/pkg/tximport/man/tximport.html'>tximport</a></code> can be selected, additionally to the newly implemented <code>bustools</code> support for single-cell data. If you have single-cell data, the use of <code>alevin</code> or <code>bustools</code> is proposed.</p><ul>
<li><p><code>'salmon'</code></p></li>
<li><p><code>'alevin'</code></p></li>
<li><p><code>'kallisto'</code></p></li>
<li><p><code>'bustools'</code></p></li>
<li><p><code>'rsem'</code></p></li>
<li><p><code>'stringtie'</code></p></li>
<li><p><code>'sailfish'</code></p></li>
<li><p><code>'none'</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/pkg/tximport/man/tximport.html'>tximport::tximport</a></code></p><dl'>
    <dt><code>txIn</code></dt><dd><p>logical, whether the incoming files are transcript level (default TRUE)</p></dd>
    <dt><code>txOut</code></dt><dd><p>logical, whether the function should just output
transcript-level (default FALSE)</p></dd>
    <dt><code>countsFromAbundance</code></dt><dd><p>character, either "no" (default), "scaledTPM",
"lengthScaledTPM", or "dtuScaledTPM".
Whether to generate estimated counts using abundance estimates:
<ul>
<li><p>scaled up to library size (scaledTPM),</p></li>
<li><p>scaled using the average transcript length over samples
        and then the library size (lengthScaledTPM), or</p></li>
<li><p>scaled using the median transcript length among isoforms of a gene,
        and then the library size (dtuScaledTPM).</p></li>
</ul>
dtuScaledTPM is designed for DTU analysis in combination with <code>txOut=TRUE</code>,
and it requires specifing a <code>tx2gene</code> data.frame.
dtuScaledTPM works such that within a gene, values from all samples and
all transcripts get scaled by the same fixed median transcript length.
If using scaledTPM, lengthScaledTPM, or geneLengthScaledTPM, 
the counts are no longer correlated across samples with transcript length,
and so the length offset matrix should not be used.</p></dd>
    <dt><code>tx2gene</code></dt><dd><p>a two-column data.frame linking transcript id (column 1)
to gene id (column 2).
the column names are not relevant, but this column order must be used. 
this argument is required for gene-level summarization for methods
that provides transcript-level estimates only
(kallisto, Salmon, Sailfish)</p></dd>
    <dt><code>varReduce</code></dt><dd><p>whether to reduce per-sample inferential replicates
information into a matrix of sample variances <code>variance</code> (default FALSE).
alevin computes inferential variance by default for bootstrap
inferential replicates, so this argument is ignored/not necessary</p></dd>
    <dt><code>dropInfReps</code></dt><dd><p>whether to skip reading in inferential replicates
(default FALSE). For alevin, <code>tximport</code> will still read in the
inferential variance matrix if it exists</p></dd>
    <dt><code>infRepStat</code></dt><dd><p>a function to re-compute counts and abundances from the
inferential replicates, e.g. <code><a href='https://rdrr.io/pkg/matrixStats/man/rowMedians.html'>matrixStats::rowMedians</a></code> to re-compute counts 
as the median of the inferential replicates. The order of operations is:
first counts are re-computed, then abundances are re-computed.
Following this, if <code>countsFromAbundance</code> is not "no",
<code>tximport</code> will again re-compute counts from the re-computed abundances.
<code>infRepStat</code> should operate on rows of a matrix. (default is NULL)</p></dd>
    <dt><code>ignoreTxVersion</code></dt><dd><p>logical, whether to split the tx id on the '.' character
to remove version information to facilitate matching with the tx id in <code>tx2gene</code>
(default FALSE)</p></dd>
    <dt><code>ignoreAfterBar</code></dt><dd><p>logical, whether to split the tx id on the '|' character
to facilitate matching with the tx id in <code>tx2gene</code> (default FALSE)</p></dd>
    <dt><code>geneIdCol</code></dt><dd><p>name of column with gene id. if missing, the <code>tx2gene</code> argument can be used</p></dd>
    <dt><code>txIdCol</code></dt><dd><p>name of column with tx id</p></dd>
    <dt><code>abundanceCol</code></dt><dd><p>name of column with abundances (e.g. TPM or FPKM)</p></dd>
    <dt><code>countsCol</code></dt><dd><p>name of column with estimated counts</p></dd>
    <dt><code>lengthCol</code></dt><dd><p>name of column with feature length information</p></dd>
    <dt><code>importer</code></dt><dd><p>a function used to read in the files</p></dd>
    <dt><code>existenceOptional</code></dt><dd><p>logical, should tximport not check if files exist before attempting
import (default FALSE, meaning files must exist according to <code>file.exists</code>)</p></dd>
    <dt><code>sparse</code></dt><dd><p>logical, whether to try to import data sparsely (default is FALSE).
Initial implementation for <code>txOut=TRUE</code>, <code>countsFromAbundance="no"</code>
or <code>"scaledTPM"</code>, no inferential replicates. Only counts matrix
is returned (and abundance matrix if using <code>"scaledTPM"</code>)</p></dd>
    <dt><code>sparseThreshold</code></dt><dd><p>the minimum threshold for including a count as a
non-zero count during sparse import (default is 1)</p></dd>
    <dt><code>readLength</code></dt><dd><p>numeric, the read length used to calculate counts from
StringTie's output of coverage. Default value (from StringTie) is 75.
The formula used to calculate counts is:
<code>cov * transcript length / read length</code></p></dd>
    <dt><code>forceSlow</code></dt><dd><p>logical, argument used for testing. Will force the use of
the slower R code for importing alevin, even if <code>fishpond</code>
library is installed. Default is FALSE</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<ul>
<li><p>For bulk data: A combined count matrix for all specified samples.</p></li>
<li><p>For single-cell data (<code>type='alevin'</code>): A list of count matrices per sample. Should be combined and optionally added to a Seurat object with <code><a href='combine_to_matrix.html'>combine_to_matrix()</a></code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Can perform multiple scaling schemes, defaults to scaling schemes appropriate for DTU analysis. For bulk data it is recommended to additionally specify a <code>tx2gene</code> data frame as parameter.
This data frame must be a a two-column data frame linking transcript id (column 1) to gene id/name (column 2). This data frame is used to apply a DTU specific scaling scheme (dtuScaledTPM).
Please see <code><a href='import_gtf.html'>import_gtf()</a></code>, <code><a href='move_columns_to_front.html'>move_columns_to_front()</a></code> and <code><a href='one_to_one_mapping.html'>one_to_one_mapping()</a></code> to help with tx2gene creation.
See also <code><a href='combine_to_matrix.html'>combine_to_matrix()</a></code>, when output is a list of single-cell runs.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Please see <code><a href='import_gtf.html'>import_gtf()</a></code>, <code><a href='move_columns_to_front.html'>move_columns_to_front()</a></code> and <code><a href='one_to_one_mapping.html'>one_to_one_mapping()</a></code> to help with tx2gene creation. See also <code><a href='combine_to_matrix.html'>combine_to_matrix()</a></code>, when output is a list of single-cell runs.</p>
<p>Other DTUrtle: 
<code><a href='combine_to_matrix.html'>combine_to_matrix</a>()</code>,
<code><a href='posthoc_and_stager.html'>posthoc_and_stager</a>()</code>,
<code><a href='run_drimseq.html'>run_drimseq</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://hesselberthlab.org'>Tobias Tekath</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


