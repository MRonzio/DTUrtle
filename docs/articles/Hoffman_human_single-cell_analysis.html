<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of the Hoffman et al. human single-cell RNA-seq data • DTUrtle</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Analysis of the Hoffman et al. human single-cell RNA-seq data">
<meta property="og:description" content="Exemplified analysis of human single-cell RNA-seq data.">
<meta property="og:image" content="https://tobitekath.github.io/DTUrtle/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DTUrtle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html">Vignette overview</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Single-cell</li>
    <li>
      <a></a>
    </li>
    <li class="dropdown-header">Illumina SureCell</li>
    <li>
      <a href="../articles/Hoffman_human_single-cell_preprocess.html">Human single-cell RNA-seq pre-processing</a>
    </li>
    <li>
      <a href="../articles/Hoffman_human_single-cell_analysis.html">Human single-cell RNA-seq analysis</a>
    </li>
    <li>
      <a></a>
    </li>
    <li class="dropdown-header">10X Chromium</li>
    <li>
      <a href="../articles/Tabular_Muris_mouse_single-cell_preprocess.Rmd">Mouse Tabular Muris single-cell RNA-seq pre-processing</a>
    </li>
    <li>
      <a href="../articles/Tabular_Muris_mouse_single-cell_analysis.Rmd">Mouse Tabular Muris single-cell RNA-seq analysis</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Bulk</li>
    <li>
      <a href="../articles/Hoffman_human_bulk_preprocess.html">Human bulk RNA-seq pre-processing</a>
    </li>
    <li>
      <a href="../articles/Hoffman_human_bulk_analysis.html">Human bulk RNA-seq analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TobiTekath/DTUrtle/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="Hoffman_human_single-cell_analysis_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/anchor-sections-1.0/anchor-sections.js"></script><script src="Hoffman_human_single-cell_analysis_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="Hoffman_human_single-cell_analysis_files/jquery-1.12.4/jquery.min.js"></script><link href="Hoffman_human_single-cell_analysis_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/datatables-binding-0.16/datatables.js"></script><link href="Hoffman_human_single-cell_analysis_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Hoffman_human_single-cell_analysis_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="Hoffman_human_single-cell_analysis_files/jszip-1.10.20/jszip.min.js"></script><link href="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="Hoffman_human_single-cell_analysis_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="Hoffman_human_single-cell_analysis_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="Hoffman_human_single-cell_analysis_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/selectize-0.12.0/selectize.min.js"></script><link href="Hoffman_human_single-cell_analysis_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="Hoffman_human_single-cell_analysis_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of the Hoffman et al. human single-cell RNA-seq data</h1>
                        <h4 class="author">Tobias Tekath</h4>
            
            <h4 class="date">2020-10-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TobiTekath/DTUrtle/blob/master/vignettes/Hoffman_human_single-cell_analysis.Rmd"><code>vignettes/Hoffman_human_single-cell_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>Hoffman_human_single-cell_analysis.Rmd</code></div>

    </div>

    
    
<p>This vignette exemplifies the analysis of <strong>single-cell RNA-seq data with DTUrtle</strong>. The data used in this vignette is publicly available as <em>Bioproject PRJNA594939</em> and the used <em>FASTQ</em>-files can be downloaded from <a href="https://www.ebi.ac.uk/ena/browser/view/PRJNA594939">here</a>. The corresponding publication from Hoffman et al. can be found <a href="https://doi.org/10.1038/s42003-020-0837-0">here</a>.</p>
<hr>
<p>The following code shows an example of an DTUrtle workflow. Assume we have performed the preprocessing as described <a href="https://tobitekath.github.io/DTUrtle/articles/Hoffman_human_single-cell_preprocess.html">here</a> and the R working directory is a newly created folder called <code>dtu_results</code>.</p>
<hr>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>Load the DTUrtle package and set the BiocParallel parameter. It is recommended to perform computations in parallel, if possible.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TobiTekath/DTUrtle">DTUrtle</a></span><span class="op">)</span>
<span class="co">#use up to 10 cores for computation</span>
<span class="va">biocpar</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html">MulticoreParam</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></pre></div>
<hr>
</div>
<div id="import-and-format-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-format-data" class="anchor"></a>Import and format data</h2>
<p>We want to start by reading in our quantification counts, as well as a file specifying which transcript ID or name belongs to which gene ID or name.</p>
<div id="importing-and-processing-gtf-annotation-tx2gene" class="section level3">
<h3 class="hasAnchor">
<a href="#importing-and-processing-gtf-annotation-tx2gene" class="anchor"></a>Importing and processing GTF annotation (tx2gene)</h3>
<p>To get this transcript to gene (<code>tx2gene</code>) mapping, we will utilize the already present Gencode annotation file <code>gencode.v34.annotation.gtf</code>. The <code><a href="../reference/import_gtf.html">import_gtf()</a></code> function utilizes the a <code>rtracklayer</code> package and returns a transcript-level filtered version of the available data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">tx2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_gtf.html">import_gtf</a></span><span class="op">(</span>gtf_file <span class="op">=</span> <span class="st">"../gencode.v34.annotation.gtf"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tx2gene</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;   seqnames start   end width strand source       type score phase</span>
<span class="co">#&gt; 1     chr1 11869 14409  2541      + HAVANA transcript    NA    NA</span>
<span class="co">#&gt; 2     chr1 12010 13670  1661      + HAVANA transcript    NA    NA</span>
<span class="co">#&gt; 3     chr1 14404 29570 15167      - HAVANA transcript    NA    NA</span>
<span class="co">#&gt;             gene_id                          gene_type gene_name level</span>
<span class="co">#&gt; 1 ENSG00000223972.5 transcribed_unprocessed_pseudogene   DDX11L1     2</span>
<span class="co">#&gt; 2 ENSG00000223972.5 transcribed_unprocessed_pseudogene   DDX11L1     2</span>
<span class="co">#&gt; 3 ENSG00000227232.5             unprocessed_pseudogene    WASH7P     2</span>
<span class="co">#&gt;      hgnc_id          havana_gene     transcript_id</span>
<span class="co">#&gt; 1 HGNC:37102 OTTHUMG00000000961.1 ENST00000456328.2</span>
<span class="co">#&gt; 2 HGNC:37102 OTTHUMG00000000961.1 ENST00000450305.2</span>
<span class="co">#&gt; 3 HGNC:38034 OTTHUMG00000000958.1 ENST00000488147.1</span>
<span class="co">#&gt;                      transcript_type transcript_name transcript_support_level</span>
<span class="co">#&gt; 1               processed_transcript     DDX11L1-202                        1</span>
<span class="co">#&gt; 2 transcribed_unprocessed_pseudogene     DDX11L1-201                       NA</span>
<span class="co">#&gt; 3             unprocessed_pseudogene      WASH7P-201                       NA</span>
<span class="co">#&gt;     tag    havana_transcript exon_number exon_id         ont protein_id ccdsid</span>
<span class="co">#&gt; 1 basic OTTHUMT00000362751.1        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 2 basic OTTHUMT00000002844.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000019       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 3 basic OTTHUMT00000002839.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000005       &lt;NA&gt;   &lt;NA&gt;</span></pre></div>
<p>There are a lot of columns present in the data frame, but at the moment we are mainly interested in the columns <code>gene_id</code>, <code>gene_name</code>, <code>transcript_id</code> and <code>transcript_name</code>.</p>
<hr>
<p>As we want to use gene and transcript names as the main identifiers in our analysis (so we can directly say: Gene x is differential), we should ensure that each gene / transcript name maps only to a single gene / transcript id.</p>
<p>For this we can use the DTUrtle function <code><a href="../reference/one_to_one_mapping.html">one_to_one_mapping()</a></code>, which checks if there are identifiers, which relate to the same name. If this is the case, the names (<strong>not</strong> the identifiers) are slightly altered by appending a number. If <em>id_x</em> and <em>id_y</em> both have the name <em>ABC</em>, the <em>id_y</em> name is altered to <em>ABC_2</em> by default.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">tx2gene</span><span class="op">$</span><span class="va">gene_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/one_to_one_mapping.html">one_to_one_mapping</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">tx2gene</span><span class="op">$</span><span class="va">gene_name</span>, id <span class="op">=</span> <span class="va">tx2gene</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span>
<span class="co">#&gt; Changed 78 names.</span>
<span class="va">tx2gene</span><span class="op">$</span><span class="va">transcript_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/one_to_one_mapping.html">one_to_one_mapping</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">tx2gene</span><span class="op">$</span><span class="va">transcript_name</span>, id <span class="op">=</span> <span class="va">tx2gene</span><span class="op">$</span><span class="va">transcript_id</span><span class="op">)</span>
<span class="co">#&gt; Changed 161 names.</span></pre></div>
<p>We see that it was a good idea to ensure the one to one mapping, as many doublets have been corrected.</p>
<hr>
<p>For the <code><a href="../reference/run_drimseq.html">run_drimseq()</a></code> <code>tx2gene</code> parameter, we need a data frame, where the first column specifies the transcript identifiers and the second column specifying the corresponding gene names. Rather than subsetting the data frame, a column reordering is proposed, so that additional data can still be used in further steps. DTUrtle makes sure to carry over additional data columns in the analysis steps. To reorder the columns of our tx2gene data frame, we can utilize the <code><a href="../reference/move_columns_to_front.html">move_columns_to_front()</a></code> functionality.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">tx2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/move_columns_to_front.html">move_columns_to_front</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">tx2gene</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"transcript_name"</span>, <span class="st">"gene_name"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tx2gene</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt;   transcript_name   gene_name seqnames start   end width strand  source</span>
<span class="co">#&gt; 1     DDX11L1-202     DDX11L1     chr1 11869 14409  2541      +  HAVANA</span>
<span class="co">#&gt; 2     DDX11L1-201     DDX11L1     chr1 12010 13670  1661      +  HAVANA</span>
<span class="co">#&gt; 3      WASH7P-201      WASH7P     chr1 14404 29570 15167      -  HAVANA</span>
<span class="co">#&gt; 4   MIR6859-1-201   MIR6859-1     chr1 17369 17436    68      - ENSEMBL</span>
<span class="co">#&gt; 5 MIR1302-2HG-202 MIR1302-2HG     chr1 29554 31097  1544      +  HAVANA</span>
<span class="co">#&gt;         type score phase           gene_id                          gene_type</span>
<span class="co">#&gt; 1 transcript    NA    NA ENSG00000223972.5 transcribed_unprocessed_pseudogene</span>
<span class="co">#&gt; 2 transcript    NA    NA ENSG00000223972.5 transcribed_unprocessed_pseudogene</span>
<span class="co">#&gt; 3 transcript    NA    NA ENSG00000227232.5             unprocessed_pseudogene</span>
<span class="co">#&gt; 4 transcript    NA    NA ENSG00000278267.1                              miRNA</span>
<span class="co">#&gt; 5 transcript    NA    NA ENSG00000243485.5                             lncRNA</span>
<span class="co">#&gt;   level    hgnc_id          havana_gene     transcript_id</span>
<span class="co">#&gt; 1     2 HGNC:37102 OTTHUMG00000000961.1 ENST00000456328.2</span>
<span class="co">#&gt; 2     2 HGNC:37102 OTTHUMG00000000961.1 ENST00000450305.2</span>
<span class="co">#&gt; 3     2 HGNC:38034 OTTHUMG00000000958.1 ENST00000488147.1</span>
<span class="co">#&gt; 4     3 HGNC:50039                 &lt;NA&gt; ENST00000619216.1</span>
<span class="co">#&gt; 5     2 HGNC:52482 OTTHUMG00000000959.1 ENST00000473358.1</span>
<span class="co">#&gt;                      transcript_type transcript_support_level   tag</span>
<span class="co">#&gt; 1               processed_transcript                        1 basic</span>
<span class="co">#&gt; 2 transcribed_unprocessed_pseudogene                       NA basic</span>
<span class="co">#&gt; 3             unprocessed_pseudogene                       NA basic</span>
<span class="co">#&gt; 4                              miRNA                       NA basic</span>
<span class="co">#&gt; 5                             lncRNA                        5 basic</span>
<span class="co">#&gt;      havana_transcript exon_number exon_id         ont protein_id ccdsid</span>
<span class="co">#&gt; 1 OTTHUMT00000362751.1        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 2 OTTHUMT00000002844.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000019       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 3 OTTHUMT00000002839.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000005       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 4                 &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; 5 OTTHUMT00000002840.1        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;</span></pre></div>
<p>This concludes the tx2gene formatting.</p>
<hr>
</div>
<div id="reading-in-quantification-data" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-in-quantification-data" class="anchor"></a>Reading in quantification data</h3>
<p>The read-in of the quantification counts can be achieved with <code><a href="../reference/import_counts.html">import_counts()</a></code>, which uses the <code>tximport</code> package in the background. This function is able to parse the output of many different quantification tools. Advanced users might be able to tune parameters to parse arbitrary output files from currently not supported tools.</p>
<p>In the pre-processing vignette we quantified the counts with <code>Alevin</code>. The folder structure of the quantification results folder looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"../alevin/"</span><span class="op">)</span>
<span class="co">#&gt; [1] "index"     "sc_Dex2hr" "sc_EtOH"   "txmap.tsv"</span></pre></div>
<p>We will create a named files vector, pointing to the <code>quants_mat.gz</code> file for each sample. The names help to differentiate the samples later on.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.glob.html">Sys.glob</a></span><span class="op">(</span><span class="st">"../alevin/sc_*/alevin/quants_mat.gz"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sc_Dex2hr"</span>, <span class="st">"sc_EtOH"</span><span class="op">)</span></pre></div>
<p>The files object looks like this:</p>
<pre><code>#&gt;                                  sc_Dex2hr 
#&gt; "../alevin/sc_Dex2hr/alevin/quants_mat.gz" 
#&gt;                                    sc_EtOH 
#&gt;   "../alevin/sc_EtOH/alevin/quants_mat.gz"</code></pre>
<p>The actual import will be performed with <code><a href="../reference/import_counts.html">import_counts()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">cts_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_counts.html">import_counts</a></span><span class="op">(</span>files <span class="op">=</span> <span class="va">files</span>, type <span class="op">=</span> <span class="st">"alevin"</span><span class="op">)</span>
<span class="co">#&gt; Reading in 2 alevin runs.</span>
<span class="co">#&gt; importing alevin data is much faster after installing `fishpond` (&gt;= 1.2.0)</span>
<span class="co">#&gt; reading in alevin gene-level counts across cells</span>
<span class="co">#&gt; importing alevin data is much faster after installing `fishpond` (&gt;= 1.2.0)</span>
<span class="co">#&gt; reading in alevin gene-level counts across cells</span></pre></div>
<p>The <code>cts_list</code> object is a named list, with a sparse Matrix per sample. In single-cell data, each sample normally consists of many different cells with an unique cell barcode. These cell barcodes might overlap between samples though. For this reason, many single-cell workflow use a cell barcode extension, uniquely assigning each cell to a sample. This can also be done in DTUrtle with <code><a href="../reference/combine_to_matrix.html">combine_to_matrix()</a></code>, which is only applicable if you are analyzing single-cell data.</p>
<p>This function will make sure that there are no duplicated barcodes between you samples, before merging the matrices together. If there are duplicated barcodes, a cell extension is added. Additionally, all not expressed features are removed to reduce the size of the data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">cts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_to_matrix.html">combine_to_matrix</a></span><span class="op">(</span>tx_list <span class="op">=</span> <span class="va">cts_list</span><span class="op">)</span>
<span class="co">#&gt; Merging matrices</span>
<span class="co">#&gt; Excluding 149854 overall not expressed features.</span>
<span class="co">#&gt; 77347 features left.</span></pre></div>
<p>Apparently there were no duplicated cell barcodes between our samples, so a cell barcode extension is not necessary. Optionally you could still force the addition by specifying a vector of <code>cell_extensions</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cts</span><span class="op">)</span>
<span class="co">#&gt; [1] 77347   796</span></pre></div>
<p>There are ~77k features left for 796 cells.</p>
<hr>
</div>
<div id="sample-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#sample-metadata" class="anchor"></a>Sample metadata</h3>
<p>Finally, we need a sample metadata data frame, specifying which sample belongs to which comparison group. This table is also convenient to store and carry over additional metadata.</p>
<p>For single-cell data, this is not a sample metadata data frame, but a cell metadata data frame. We have to specify the information on cell level, with the barcodes as identifiers.</p>
<p>If such a table is not already present, it can be easily prepared:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cts</span><span class="op">)</span>, 
                 <span class="st">"group"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cts</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cts_list</span><span class="op">$</span><span class="va">sc_Dex2hr</span><span class="op">)</span>,<span class="st">"Dex2hr"</span>,<span class="st">"EtOH"</span><span class="op">)</span>,  
                 stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pd</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt;                   id  group</span>
<span class="co">#&gt; 1 GCCAGAGCGAATGTTAAC Dex2hr</span>
<span class="co">#&gt; 2 TGAATTCAGACTAGTCTG Dex2hr</span>
<span class="co">#&gt; 3 CGGCGTCTTACGTTCTTG Dex2hr</span>
<span class="co">#&gt; 4 TCGGGAGGACGATACCGA Dex2hr</span>
<span class="co">#&gt; 5 TCGGGACCTCTAGAGTGA Dex2hr</span></pre></div>
<hr>
</div>
</div>
<div id="dtu-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#dtu-analysis" class="anchor"></a>DTU analysis</h2>
<p>We have prepared all necessary data to perform the differentially transcript usage (DTU) analysis. DTUrtle only needs two simple commands to perform it. Please be aware that these steps are the most compute intensive and, depending on your data, might take some time to complete. It is recommended to parallelize the computations with the <code>BBPARAM</code> parameter, if applicable.</p>
<p>First, we want to set-up and perform the statistical analysis with DRIMSeq, a DTU specialized statistical framework utilizing a Dirichlet-multinomial model. This can be done with the <code><a href="../reference/run_drimseq.html">run_drimseq()</a></code> command. We use the previously imported data as parameters, specifying which column in the cell metadata data frame contains ids and which the group information we want. We should also specify which of the groups should be compared (if there are more than two) and in which order. The order given in the <code>cond_levels</code> parameter also specifies the comparison formula.</p>
<blockquote>
<div class="alert alert-info">
<p><strong>Note:</strong> By default <code><a href="../reference/run_drimseq.html">run_drimseq()</a></code> converts sparse count matrix to a dense format for statistical computations (<code>force_dense=TRUE</code>). While this increases memory usage, it currently also reduces the run time. The computations can be performed keeping the sparse counts by setting <code>force_dense=FALSE</code>.</p>
</div>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">dturtle &lt;-<span class="st"> </span><span class="kw">run_drimseq</span>(<span class="dt">counts =</span> cts, <span class="dt">tx2gene =</span> tx2gene, <span class="dt">pd=</span>pd, <span class="dt">id_col =</span> <span class="st">"id"</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">                    <span class="dt">cond_col =</span> <span class="st">"group"</span>, <span class="dt">cond_levels =</span> <span class="kw">c</span>(<span class="st">"Dex2hr"</span>, <span class="st">"EtOH"</span>), <span class="dt">filtering_strategy =</span> <span class="st">"sc"</span>, </a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                    <span class="dt">BPPARAM =</span> biocpar)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; Using tx2gene columns:</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;  transcript_name ---&gt; 'feature_id'</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt;  gene_name ---&gt; 'gene_id'</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; Comparing Dex2hr vs EtOH</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; Proceed with cells/samples: </span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; Dex2hr   EtOH </span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt;    399    397</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt; Filtering...</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb15-28" data-line-number="28">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb15-30" data-line-number="30">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb15-32" data-line-number="32">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb15-34" data-line-number="34">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb15-36" data-line-number="36">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co">#&gt; Retain 21452 of 77347 features.</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="co">#&gt; Removed 55895 features.</span></a>
<a class="sourceLine" id="cb15-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-41" data-line-number="41"><span class="co">#&gt; Performing statistical tests...</span></a>
<a class="sourceLine" id="cb15-42" data-line-number="42"><span class="co">#&gt; * Calculating mean gene expression..</span></a>
<a class="sourceLine" id="cb15-43" data-line-number="43"><span class="co">#&gt; Took 0.6488 seconds.</span></a>
<a class="sourceLine" id="cb15-44" data-line-number="44"><span class="co">#&gt; * Estimating common precision..</span></a>
<a class="sourceLine" id="cb15-45" data-line-number="45"><span class="co">#&gt; Took 2.0406 seconds.</span></a>
<a class="sourceLine" id="cb15-46" data-line-number="46"><span class="co">#&gt; ! Using common_precision = 993.3516 as prec_init !</span></a>
<a class="sourceLine" id="cb15-47" data-line-number="47"><span class="co">#&gt; * Estimating genewise precision..</span></a>
<a class="sourceLine" id="cb15-48" data-line-number="48"><span class="co">#&gt; ! Using loess fit as a shrinkage factor !</span></a>
<a class="sourceLine" id="cb15-49" data-line-number="49"><span class="co">#&gt; Took 8.4099 seconds.</span></a>
<a class="sourceLine" id="cb15-50" data-line-number="50"><span class="co">#&gt; * Fitting the DM model..</span></a>
<a class="sourceLine" id="cb15-51" data-line-number="51"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb15-52" data-line-number="52"><span class="co">#&gt; Took 11.1801 seconds.</span></a>
<a class="sourceLine" id="cb15-53" data-line-number="53"><span class="co">#&gt; * Fitting the BB model..</span></a>
<a class="sourceLine" id="cb15-54" data-line-number="54"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb15-55" data-line-number="55"><span class="co">#&gt; Took 3.3568 seconds.</span></a>
<a class="sourceLine" id="cb15-56" data-line-number="56"><span class="co">#&gt; * Fitting the DM model..</span></a>
<a class="sourceLine" id="cb15-57" data-line-number="57"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb15-58" data-line-number="58"><span class="co">#&gt; Took 8.4501 seconds.</span></a>
<a class="sourceLine" id="cb15-59" data-line-number="59"><span class="co">#&gt; * Calculating likelihood ratio statistics..</span></a>
<a class="sourceLine" id="cb15-60" data-line-number="60"><span class="co">#&gt; Took 0.003 seconds.</span></a>
<a class="sourceLine" id="cb15-61" data-line-number="61"><span class="co">#&gt; * Fitting the BB model..</span></a>
<a class="sourceLine" id="cb15-62" data-line-number="62"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb15-63" data-line-number="63"><span class="co">#&gt; Took 2.1739 seconds.</span></a>
<a class="sourceLine" id="cb15-64" data-line-number="64"><span class="co">#&gt; * Calculating likelihood ratio statistics..</span></a>
<a class="sourceLine" id="cb15-65" data-line-number="65"><span class="co">#&gt; Took 0.0103 seconds.</span></a></code></pre></div>
<p>As in all statistical procedures, it is of favor to perform as few tests as possible but as much tests as necessary, to maintain a high statistical power. This is achieved by filtering the data to remove inherently uninteresting items, for example very lowly expressed genes or features. DTUrtle includes a powerful and customizable filtering functionality for this task, which is an optimized version of the <code>dmFilter()</code> function of the DRIMSeq package.</p>
<p>Above we used a predefined filtering strategy for single-cell data, requiring that features contribute at least 5% of the total expression in at least 5% of the cells of the smallest group. Additionally, all genes are filtered, which only have a single transcript left, as they can not be analyzed in DTU analysis. The filtering options can be extended or altered by the user.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">dturtle</span><span class="op">$</span><span class="va">used_filtering_options</span>
<span class="co">#&gt; $DRIM</span>
<span class="co">#&gt; $DRIM$min_samps_gene_expr</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$min_samps_feature_expr</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$min_samps_feature_prop</span>
<span class="co">#&gt; [1] 19.85</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$min_gene_expr</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$min_feature_expr</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$min_feature_prop</span>
<span class="co">#&gt; [1] 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DRIM$run_gene_twice</span>
<span class="co">#&gt; [1] TRUE</span></pre></div>
<p>The resulting <code>dturtle</code> object will be used as our main results object, storing all necessary and interesting data of the analysis. It is a simple and easy-accessible list, which can be easily extended / altered by the user. By default three different meta data tables are generated: - <code>meta_table_gene</code>: Contains gene level meta data. - <code>meta_table_tx</code>: Contains transcript level meta data. - <code>meta_table_sample</code>: Contains sample level meta data (as the created <code>pd</code> data frame)</p>
<p>These meta data tables are used in for visualization purposes and can be extended by the user.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">dturtle</span><span class="op">$</span><span class="va">meta_table_gene</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt;        gene     exp_in exp_in_Dex2hr exp_in_EtOH seqnames</span>
<span class="co">#&gt; A1BG   A1BG 0.03768844    0.04511278  0.03022670    chr19</span>
<span class="co">#&gt; AAAS   AAAS 0.04020101    0.04511278  0.03526448    chr12</span>
<span class="co">#&gt; AAGAB AAGAB 0.07286432    0.09273183  0.05289673    chr15</span>
<span class="co">#&gt; AAMDC AAMDC 0.03894472    0.03508772  0.04282116    chr11</span>
<span class="co">#&gt; AAMP   AAMP 0.09422111    0.09774436  0.09068010     chr2</span></pre></div>
<hr>
<p>As proposed in <a href="https://doi.org/10.12688/f1000research.15398.3">Love et al. (2018)</a>, we will use a two-stage statistical testing procedure together with a post-hoc filtering on the standard deviations in proportions (<code><a href="../reference/posthoc_and_stager.html">posthoc_and_stager()</a></code>). We will use <em>stageR</em> to determine genes, that show a overall significant change in transcript proportions. For these significant genes, we will try to pinpoint specific transcripts, which significantly drive this overall change. As a result, we will have a list of <code>significant genes</code> (genes showing the overall change) and a list of <code>significant transcripts</code> (one or more transcripts of the <code>significant genes</code>). Please note, that not every <code>significant gene</code> does have one or more <code>significant trasncripts</code>. It is not always possible to attribute the overall change in proportions to single transcripts. These two list of significant items are computed and corrected against a <strong>overall false discovery rate (OFDR)</strong>.</p>
<p>Additionally, we will apply a post-hoc filtering scheme to improve the targeted OFDR control level. The filtering strategy will discard transcripts, which standard deviation of the proportion per cell/sample is below the specified threshold. For example by setting <code>posthoc=0.1</code>, we will exclude all transcripts, which proportional expression (in regard to the total gene expression) deviates by less than 0.1 between cells. This filtering step should mostly exclude ‘uninteresting’ transcripts, which would not have been called as significant either way.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">dturtle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posthoc_and_stager.html">posthoc_and_stager</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, ofdr <span class="op">=</span> <span class="fl">0.05</span>, posthoc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co">#&gt; Posthoc filtered 20608 features.</span>
<span class="co">#&gt; The returned adjusted p-values are based on a stage-wise testing approach and are only valid for the provided target OFDR level of 5%. If a different target OFDR level is of interest,the entire adjustment should be re-run.</span>
<span class="co">#&gt; Found 32 significant genes with 37 significant transcripts (OFDR: 0.05)</span></pre></div>
<p>The <code>dturtle</code> object now contains additional elements, including the lists of <code>significant genes</code> and <code>significant transcripts</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">sig_gene</span><span class="op">)</span>
<span class="co">#&gt; [1] "AGR2"    "ATP5F1B" "COX6A1"  "EEF1A1"  "HSPB1"   "NPM1"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">sig_tx</span><span class="op">)</span>
<span class="co">#&gt;          AGR2          AGR2       ATP5F1B       ATP5F1B        COX6A1 </span>
<span class="co">#&gt;    "AGR2-203"    "AGR2-204" "ATP5F1B-204" "ATP5F1B-201"  "COX6A1-201" </span>
<span class="co">#&gt;        COX6A1 </span>
<span class="co">#&gt;  "COX6A1-202"</span></pre></div>
<hr>
</div>
<div id="result-aggregation-and-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#result-aggregation-and-visualization" class="anchor"></a>Result aggregation and visualization</h2>
<p>The <code>DTUrtle</code> package contains multiple visualization options, enabling a in-depth inspection.</p>
<div id="dtu-table-creation" class="section level3">
<h3 class="hasAnchor">
<a href="#dtu-table-creation" class="anchor"></a>DTU table creation</h3>
<p>We will start by aggregating the analysis results to a data frame with <code><a href="../reference/create_dtu_table.html">create_dtu_table()</a></code>. This function is highly flexible and allows aggregation of gene or transcript level metadata in various ways. By default some useful information are included in the <em>dtu table</em>, in this example we further specify to include the <code>seqnames</code> column of the gene level metadata (which contains chromosome information) as well as the maximal <em>expressed in</em> ratio from the transcript level metadata.</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">dturtle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dtu_table.html">create_dtu_table</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, add_gene_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"chromosome"</span><span class="op">=</span><span class="st">"seqnames"</span><span class="op">)</span>, 
                               add_tx_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"tx_expr_in_max"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"exp_in"</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">dtu_table</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt;         gene_ID  gene_qvalue minimal_tx_qvalue number_tx number_significant_tx</span>
<span class="co">#&gt; PSMB4     PSMB4 2.384975e-03      7.737662e-04         7                     1</span>
<span class="co">#&gt; RPL13A   RPL13A 1.594164e-12      4.288133e-14        12                     2</span>
<span class="co">#&gt; RPLP1     RPLP1 8.463652e-15      1.744164e-16         4                     3</span>
<span class="co">#&gt; COX6A1   COX6A1 2.369833e-02      4.364625e-03         3                     2</span>
<span class="co">#&gt; ATP5F1B ATP5F1B 4.299031e-05      1.178635e-06         5                     2</span>
<span class="co">#&gt;         max(Dex2hr-EtOH) chromosome tx_expr_in_max</span>
<span class="co">#&gt; PSMB4          0.1549467       chr1      0.6306533</span>
<span class="co">#&gt; RPL13A         0.1532888      chr19      0.9183417</span>
<span class="co">#&gt; RPLP1          0.1389011      chr15      0.9623116</span>
<span class="co">#&gt; COX6A1        -0.1365187      chr12      0.5778894</span>
<span class="co">#&gt; ATP5F1B        0.1355291      chr12      0.8128141</span></pre></div>
<p>The column definitions are as follows:</p>
<ul>
<li>“gene_ID”: Gene name or identifier used for the analysis.</li>
<li>“gene_qvalue”: Multiple testing corrected p-value (a.k.a. q-value) comparing all transcripts together between the two groups (“gene level”).</li>
<li>“minimal_tx_qvalue”: The minimal multiple testing corrected p-value from comparing all transcripts individually between the two groups (“transcript level”). I.e. the q-value of the most significant transcript.</li>
<li>“number_tx”: The number of analyzed transcripts for the specific gene.</li>
<li>“number_significant_tx”: The number of significant transcripts from the ‘transcript level’ analysis.</li>
<li>“max(Dex2hr-EtOH)”: Maximal proportional difference between the two groups (Dex2hr vs EtOH). E.g. one transcript of ‘PSMB4’ is ~15% more expressed in ‘Dex2hr’ cells compared to ‘EtOH’ cells.</li>
<li>“chromosome”: the chromosome the gene resides on.</li>
<li>“tx_expr_in_max”: The fraction of cells, the most expressed transcript is expressed in. “Expressed in” is defined as expression&gt;0.</li>
</ul>
<p>This table is our basis for creating an <strong>interactive HTML-table</strong> of the results.</p>
<hr>
</div>
<div id="proportion-barplot" class="section level3">
<h3 class="hasAnchor">
<a href="#proportion-barplot" class="anchor"></a>Proportion barplot</h3>
<p>As a first visualization option we will create a barplot of the proportions of each transcript per sample. We can use the function <code><a href="../reference/plot_proportion_barplot.html">plot_proportion_barplot()</a></code> for this task, which also adds the mean proportion fit per subgroup to the plot (by default as a red line).</p>
<p>As an example, we will create the plot for the gene <em>PPIA</em>, which is one of the significant genes found in the analysis. We will optionally provide the gene_id for <em>PPIA</em>, which is stored in the column <code>gene_id.1</code> of <code>dturtle$meta_table_gene</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_proportion_barplot.html">plot_proportion_barplot</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, genes <span class="op">=</span> <span class="st">"PPIA"</span>, meta_gene_id <span class="op">=</span> <span class="st">"gene_id.1"</span><span class="op">)</span>
<span class="co">#&gt; Creating 1 plots:</span>
<span class="va">temp</span><span class="op">$</span><span class="va">PPIA</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>We see, that most of the proportional differences for <em>PPIA</em> are driven by 2 of the 7 transcripts (<em>PPIA-204</em> and <em>PPIA-209</em>). These transcripts are also the significant transcripts found in the analysis (as they are marked in red). We additionally see, that a DGE analysis would most likely not report <em>PPIA</em> as differential, because the mean gene expression is quite alike between the groups (together with a common high coefficient of variation).</p>
<p>For the interactive HTML-table we would need to save the images to disk (in the to-be-created sub folder “images” of the current working directory). There is also a convenience option, to directly add the file paths to the <code>dtu_table</code>. As multiple plots are created, we can provide a <code>BiocParallel</code> object to speed up the creation. If no specific genes are provided, all significant genes will be plotted.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">dturtle &lt;-<span class="st"> </span><span class="kw">plot_proportion_barplot</span>(<span class="dt">dturtle =</span> dturtle, </a>
<a class="sourceLine" id="cb23-2" data-line-number="2">                                   <span class="dt">meta_gene_id =</span> <span class="st">"gene_id.1"</span>, </a>
<a class="sourceLine" id="cb23-3" data-line-number="3">                                   <span class="dt">savepath =</span> <span class="st">"images"</span>, </a>
<a class="sourceLine" id="cb23-4" data-line-number="4">                                   <span class="dt">add_to_table =</span> <span class="st">"barplot"</span>,</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">                                   <span class="dt">BPPARAM =</span> biocpar)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; Creating 32 plots:</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb23-18" data-line-number="18">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb23-22" data-line-number="22">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb23-24" data-line-number="24">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb23-26" data-line-number="26">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb23-28" data-line-number="28">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">dtu_table</span><span class="op">$</span><span class="va">barplot</span><span class="op">)</span>
<span class="co">#&gt; [1] "images/PSMB4_barplot.png"   "images/RPL13A_barplot.png" </span>
<span class="co">#&gt; [3] "images/RPLP1_barplot.png"   "images/COX6A1_barplot.png" </span>
<span class="co">#&gt; [5] "images/ATP5F1B_barplot.png" "images/RPL7A_barplot.png"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"./images/"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "AGR2_barplot.png"        "AGR2_pheatmap.png"      </span>
<span class="co">#&gt; [3] "AGR2_transcripts.png"    "ATP5F1B_barplot.png"    </span>
<span class="co">#&gt; [5] "ATP5F1B_pheatmap.png"    "ATP5F1B_transcripts.png"</span></pre></div>
<hr>
</div>
<div id="proportion-heatmap" class="section level3">
<h3 class="hasAnchor">
<a href="#proportion-heatmap" class="anchor"></a>Proportion heatmap</h3>
<p>A different visualization option is a heatmap, where additional meta data can be displayed alongside the transcript proportions (<code><a href="../reference/plot_proportion_pheatmap.html">plot_proportion_pheatmap()</a></code>). This visualization uses the <code>pheatmap</code> package, the user can specify any of the available parameters to customize the results.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_proportion_pheatmap.html">plot_proportion_pheatmap</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, genes <span class="op">=</span> <span class="st">"PPIA"</span>, 
                                 include_expression <span class="op">=</span> <span class="cn">T</span>, treeheight_col<span class="op">=</span><span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; Creating 1 plots:</span>
<span class="va">temp</span><span class="op">$</span><span class="va">PPIA</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>By default, row and column annotations are added. This plot helps to examine the transcript composition of groups of cells. We see, there is a subgroup of cells, that seem to almost only express both <em>PPIA-204</em> and <em>PPIA-209</em> at equal proportions. The same goes for a even smaller subgroup of cells, which express <em>PPIA-204</em> alongside with <em>PPIA-202</em>.</p>
<p>Again, we can save the plots to disk and add them to the <code>dtu_table</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">dturtle &lt;-<span class="st"> </span><span class="kw">plot_proportion_pheatmap</span>(<span class="dt">dturtle =</span> dturtle,</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">                                    <span class="dt">include_expression =</span> T,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">                                    <span class="dt">treeheight_col=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                                    <span class="dt">savepath =</span> <span class="st">"images"</span>, </a>
<a class="sourceLine" id="cb26-5" data-line-number="5">                                    <span class="dt">add_to_table =</span> <span class="st">"pheatmap"</span>,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">                                    <span class="dt">BPPARAM =</span> biocpar)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">#&gt; Creating 32 plots:</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb26-11" data-line-number="11">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb26-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb26-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb26-19" data-line-number="19">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-20" data-line-number="20"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb26-21" data-line-number="21">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-22" data-line-number="22"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb26-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-24" data-line-number="24"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb26-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-26" data-line-number="26"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb26-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-28" data-line-number="28"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb26-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb26-30" data-line-number="30"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">dtu_table</span><span class="op">$</span><span class="va">pheatmap</span><span class="op">)</span>
<span class="co">#&gt; [1] "images/PSMB4_pheatmap.png"   "images/RPL13A_pheatmap.png" </span>
<span class="co">#&gt; [3] "images/RPLP1_pheatmap.png"   "images/COX6A1_pheatmap.png" </span>
<span class="co">#&gt; [5] "images/ATP5F1B_pheatmap.png" "images/RPL7A_pheatmap.png"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"./images/"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "AGR2_barplot.png"        "AGR2_pheatmap.png"      </span>
<span class="co">#&gt; [3] "AGR2_transcripts.png"    "ATP5F1B_barplot.png"    </span>
<span class="co">#&gt; [5] "ATP5F1B_pheatmap.png"    "ATP5F1B_transcripts.png"</span></pre></div>
<hr>
</div>
<div id="transcript-overview" class="section level3">
<h3 class="hasAnchor">
<a href="#transcript-overview" class="anchor"></a>Transcript overview</h3>
<p>Until now, we looked at the different transcripts as abstract entities. Alongside proportional differences, the actual difference in the exon-intron structure of transcripts is of great importance for many research questions. This structure can be visualized with the <code><a href="../reference/plot_transcripts_view.html">plot_transcripts_view()</a></code> functionality of <em>DTUrtle</em>.</p>
<p>This visualization is based on the <em>Gviz</em> package and needs a path to a <em>GTF</em> file (or a read-in object). In <a href="#import-and-format-data">Import and format data</a> we already imported a GTF file. This was subset to transcript-level (via the <code><a href="../reference/import_gtf.html">import_gtf()</a></code> function), thus this is <strong>not</strong> sufficient for the visualization. We can reuse the actual <em>GTF</em> file though, which should in general match with the one used for the <code>tx2gene</code> data frame.</p>
<p>As we have ensured the one_to_one mapping in <a href="#import-and-format-data">Import and format data</a> and potentially renamed some genes, we should specify the <code>one_to_one</code> parameter in this call.</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="../reference/plot_transcripts_view.html">plot_transcripts_view</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, 
                              genes <span class="op">=</span> <span class="st">"PPIA"</span>, 
                              gtf <span class="op">=</span> <span class="st">"../gencode.v34.annotation.gtf"</span>, 
                              genome <span class="op">=</span> <span class="st">'hg38'</span>,
                              one_to_one <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Importing gtf file from disk.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Performing one to one mapping in gtf</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Found gtf GRanges for 1 of 1 provided genes.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fetching ideogram tracks ...</span>
<span class="co">#&gt; Could not generate IdeogramTrack for:</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Creating 1 plots:</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-28-1.png" width="80%" style="display: block; margin: auto;"></p>
<pre><code>#&gt; $PPIA
#&gt; $PPIA$chr7
#&gt; Ideogram track 'chr7' for chromosome 7 of the hg38 genome 
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$OverlayTrack
#&gt; OverlayTrack 'OverlayTrack' containing 2 subtracks
#&gt; 
#&gt; $PPIA$titles
#&gt; An object of class "ImageMap"
#&gt; Slot "coords":
#&gt;              x1        y1   x2        y2
#&gt; chr7          6  120.0000 58.2  188.3341
#&gt; OverlayTrack  6  188.3341 58.2  325.1435
#&gt; OverlayTrack  6  325.1435 58.2  461.9529
#&gt; OverlayTrack  6  461.9529 58.2  598.7623
#&gt; OverlayTrack  6  598.7623 58.2  735.5717
#&gt; OverlayTrack  6  735.5717 58.2  872.3812
#&gt; OverlayTrack  6  872.3812 58.2 1009.1906
#&gt; OverlayTrack  6 1009.1906 58.2 1146.0000
#&gt; 
#&gt; Slot "tags":
#&gt; $title
#&gt;           chr7   OverlayTrack   OverlayTrack   OverlayTrack   OverlayTrack 
#&gt;         "chr7" "OverlayTrack" "OverlayTrack" "OverlayTrack" "OverlayTrack" 
#&gt;   OverlayTrack   OverlayTrack   OverlayTrack 
#&gt; "OverlayTrack" "OverlayTrack" "OverlayTrack"</code></pre>
<p>This visualization shows the structure of the transcripts of <em>PPIA</em>. Our two significant transcripts (<em>PPIA-204</em> and <em>PPIA-209</em>) are quite different, with alternative start and end points as well as some retained intron sequences. The arrows on the right side indicate the mean fitted proportional change in the comparison groups, thus showing a over-expression of <em>PPIA-204</em> in <code>Dex2hr</code> compared to <code>EtOH</code>.</p>
<p>The grey areas indicate intron sequences, which have been compressed in this representation to highlight the exon structure. Only consensus introns are compressed to a defined minimal size. This can also be turned off with <code>reduce_introns=FALSE</code></p>
<p>Analogous as before, we can save plots to disk and add them to the <code>dtu_table</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">dturtle &lt;-<span class="st"> </span><span class="kw">plot_transcripts_view</span>(<span class="dt">dturtle =</span> dturtle, </a>
<a class="sourceLine" id="cb30-2" data-line-number="2">                                 <span class="dt">gtf =</span> <span class="st">"../gencode.v34.annotation.gtf"</span>, </a>
<a class="sourceLine" id="cb30-3" data-line-number="3">                                 <span class="dt">genome =</span> <span class="st">'hg38'</span>, </a>
<a class="sourceLine" id="cb30-4" data-line-number="4">                                 <span class="dt">one_to_one =</span> T,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">                                 <span class="dt">savepath =</span> <span class="st">"images"</span>, </a>
<a class="sourceLine" id="cb30-6" data-line-number="6">                                 <span class="dt">add_to_table =</span> <span class="st">"transcript_view"</span>,</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">                                 <span class="dt">BPPARAM =</span> biocpar)</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="co">#&gt; Importing gtf file from disk.</span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="co">#&gt; Performing one to one mapping in gtf</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="co">#&gt; Found gtf GRanges for 32 of 32 provided genes.</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="co">#&gt; Fetching ideogram tracks ...</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="co">#&gt; Could not generate IdeogramTrack for:</span></a>
<a class="sourceLine" id="cb30-17" data-line-number="17"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb30-18" data-line-number="18"><span class="co">#&gt; Creating 32 plots:</span></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb30-22" data-line-number="22">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb30-24" data-line-number="24">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb30-26" data-line-number="26">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-27" data-line-number="27"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb30-28" data-line-number="28">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-29" data-line-number="29"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb30-30" data-line-number="30">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-31" data-line-number="31"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb30-32" data-line-number="32">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-33" data-line-number="33"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb30-34" data-line-number="34">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-35" data-line-number="35"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb30-36" data-line-number="36">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-37" data-line-number="37"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb30-38" data-line-number="38">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-39" data-line-number="39"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb30-40" data-line-number="40">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb30-41" data-line-number="41"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">dtu_table</span><span class="op">$</span><span class="va">transcript_view</span><span class="op">)</span>
<span class="co">#&gt; [1] "images/PSMB4_transcripts.png"   "images/RPL13A_transcripts.png" </span>
<span class="co">#&gt; [3] "images/RPLP1_transcripts.png"   "images/COX6A1_transcripts.png" </span>
<span class="co">#&gt; [5] "images/ATP5F1B_transcripts.png" "images/RPL7A_transcripts.png"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"./images/"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "AGR2_barplot.png"        "AGR2_pheatmap.png"      </span>
<span class="co">#&gt; [3] "AGR2_transcripts.png"    "ATP5F1B_barplot.png"    </span>
<span class="co">#&gt; [5] "ATP5F1B_pheatmap.png"    "ATP5F1B_transcripts.png"</span></pre></div>
<hr>
</div>
<div id="visualize-dtu-table" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-dtu-table" class="anchor"></a>Visualize DTU table</h3>
<p>The <code>dturtle$dtu_table</code> is now ready to be visualized as an interactive HTML-table. Please note, that it is optional to add any plots or additional columns to the table. Thus the visualization will work directly after calling <code><a href="../reference/create_dtu_table.html">create_dtu_table()</a></code>.</p>
<p>The <code>dtu_table</code> object looks like this:</p>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dturtle</span><span class="op">$</span><span class="va">dtu_table</span><span class="op">)</span>
<span class="co">#&gt;         gene_ID  gene_qvalue minimal_tx_qvalue number_tx number_significant_tx</span>
<span class="co">#&gt; PSMB4     PSMB4 2.384975e-03      7.737662e-04         7                     1</span>
<span class="co">#&gt; RPL13A   RPL13A 1.594164e-12      4.288133e-14        12                     2</span>
<span class="co">#&gt; RPLP1     RPLP1 8.463652e-15      1.744164e-16         4                     3</span>
<span class="co">#&gt; COX6A1   COX6A1 2.369833e-02      4.364625e-03         3                     2</span>
<span class="co">#&gt; ATP5F1B ATP5F1B 4.299031e-05      1.178635e-06         5                     2</span>
<span class="co">#&gt; RPL7A     RPL7A 2.250260e-28      7.249850e-18         6                     3</span>
<span class="co">#&gt;         max(Dex2hr-EtOH) chromosome tx_expr_in_max                    barplot</span>
<span class="co">#&gt; PSMB4          0.1549467       chr1      0.6306533   images/PSMB4_barplot.png</span>
<span class="co">#&gt; RPL13A         0.1532888      chr19      0.9183417  images/RPL13A_barplot.png</span>
<span class="co">#&gt; RPLP1          0.1389011      chr15      0.9623116   images/RPLP1_barplot.png</span>
<span class="co">#&gt; COX6A1        -0.1365187      chr12      0.5778894  images/COX6A1_barplot.png</span>
<span class="co">#&gt; ATP5F1B        0.1355291      chr12      0.8128141 images/ATP5F1B_barplot.png</span>
<span class="co">#&gt; RPL7A          0.1319936       chr9      0.9786432   images/RPL7A_barplot.png</span>
<span class="co">#&gt;                            pheatmap                transcript_view</span>
<span class="co">#&gt; PSMB4     images/PSMB4_pheatmap.png   images/PSMB4_transcripts.png</span>
<span class="co">#&gt; RPL13A   images/RPL13A_pheatmap.png  images/RPL13A_transcripts.png</span>
<span class="co">#&gt; RPLP1     images/RPLP1_pheatmap.png   images/RPLP1_transcripts.png</span>
<span class="co">#&gt; COX6A1   images/COX6A1_pheatmap.png  images/COX6A1_transcripts.png</span>
<span class="co">#&gt; ATP5F1B images/ATP5F1B_pheatmap.png images/ATP5F1B_transcripts.png</span>
<span class="co">#&gt; RPL7A     images/RPL7A_pheatmap.png   images/RPL7A_transcripts.png</span></pre></div>
<p>Before creating the actual table, we can optionally define column formatter functions, which colour the specified columns. The colouring might help with to quickly dissect the results.</p>
<p><em>DTUrtle</em> come with some pre-defined column formatter functions (for p-values and percentages), other formatter functions from the <code>formattable</code> package can also be used. Advanced users might also define their own functions.</p>
<p>We create a named list, linking column names to formatter functions:</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="va">column_formatter_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="st">"gene_qvalue"</span> <span class="op">=</span> <span class="fu"><a href="../reference/table_pval_tile.html">table_pval_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
      <span class="st">"min_tx_qval"</span> <span class="op">=</span> <span class="fu"><a href="../reference/table_pval_tile.html">table_pval_tile</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
      <span class="st">"n_tx"</span> <span class="op">=</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/formattable/man/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="st">"lightblue"</span><span class="op">)</span>,
      <span class="st">"n_sig_tx"</span> <span class="op">=</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/formattable/man/color_tile.html">color_tile</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="st">"lightblue"</span><span class="op">)</span>,
      <span class="st">"max(Dex2hr-EtOH)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/table_percentage_bar.html">table_percentage_bar</a></span><span class="op">(</span><span class="st">'lightgreen'</span>, <span class="st">"#FF9999"</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,
      <span class="st">"tx_expr_in_max"</span> <span class="op">=</span> <span class="fu"><a href="../reference/table_percentage_bar.html">table_percentage_bar</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="st">"lightblue"</span>, color_break <span class="op">=</span> <span class="fl">0</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>This <code>column_formatter_list</code> is subsequently provided to <code><a href="../reference/plot_dtu_table.html">plot_dtu_table()</a></code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="fu"><a href="../reference/plot_dtu_table.html">plot_dtu_table</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle</span>, savepath <span class="op">=</span> <span class="st">"my_results.html"</span>, 
               column_formatters <span class="op">=</span> <span class="va">column_formatter_list</span><span class="op">)</span></pre></div>
<blockquote>
<div class="alert alert-info">
<p><strong>Note:</strong> ️As seen above, the paths to the plots are relative. Please make sure that the saving directory in <code><a href="../reference/plot_dtu_table.html">plot_dtu_table()</a></code> is correctly set and the plots are reachable from that directory with the given path.</p>
<p><strong>The links in the following example are just for demonstration purposes and do not work!</strong></p>
</div>
</blockquote>
<style>
.vscroll-plot {
    overflow: auto;
    resize: both;
}
</style>
<div class="vscroll-plot">
<div id="DTUrtle_table-FtdPtHOxhNqnUEH" style="width:90%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="DTUrtle_table-FtdPtHOxhNqnUEH">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"1\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","class":"display","extensions":["Buttons"],"data":[["PSMB4","RPL13A","RPLP1","COX6A1","ATP5F1B","RPL7A","RPL18A","RPS18","AGR2","RPL5","RPS12","PPIA","RPS20","RPL12","TPT1","RPS8","RPL6","RPS2","RPL30","EEF1A1","HSPB1","NPM1","RPL32","RPL8","RPS3","RPLP2","RPLP0","RPL27A","RPS6","RPL13","RPL23","RPS11"],["<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffcf7\">2.385e-03<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffe9c1\">1.594e-12<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffe4b4\">8.464e-15<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffefd\">2.370e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff8ed\">4.299e-05<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffc865\">2.250e-28<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff7e9\">9.148e-06<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffc459\">1.580e-30<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffefe\">3.635e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff7e9\">1.171e-05<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffbf5\">1.241e-03<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffe1ac\">3.298e-16<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffcf7\">2.952e-03<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff2db\">3.288e-08<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff5e3\">9.267e-07<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffefd1\">8.649e-10<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffdfb\">1.091e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffa500\">7.540e-46<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffebc6\">1.070e-11<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffd17f\">5.311e-24<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffefe\">3.666e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffefe\">4.116e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffaf2\">3.607e-04<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffd384\">4.778e-23<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffe7bc\">2.211e-13<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #ffffff\">4.988e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff0d4\">2.483e-09<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffdfb\">1.261e-02<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff3df\">1.759e-07<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fff4e1\">4.490e-07<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffdf9\">5.860e-03<\/span>","<span style=\"display: inline-block; padding: 0 8px; border-radius: 8px; background-color: #fffaf1\">2.499e-04<\/span>"],[0.0007737662,4.288133e-14,1.744164e-16,0.004364625,1.178635e-06,7.24985e-18,1.367865e-07,2.066038e-11,0.007137401,0.003910447,0,5.440457e-18,0.003101835,2.143659e-09,0.01935086,0.0007064352,0.001544767,0.6320185,1.059049e-06,1,0.005719092,1,0.03885706,1,0.8264242,1,1,1,6.33159e-08,7.408546e-06,0.004280541,1],[7,12,4,3,5,6,6,8,3,6,2,7,11,4,13,7,3,12,8,7,3,5,7,12,15,8,14,9,4,12,9,9],[1,2,3,2,2,3,1,2,2,1,2,2,1,2,1,1,1,0,3,0,1,0,1,0,0,0,0,0,1,1,1,0],["<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 100.00%\">15.49%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 98.93%\">15.33%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 89.64%\">13.89%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 88.11%\">-13.65%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 87.47%\">13.55%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 85.19%\">13.20%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 77.91%\">-12.07%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 61.91%\">9.59%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 57.49%\">-8.91%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 57.12%\">8.85%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 55.66%\">8.62%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 54.56%\">8.45%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 54.23%\">8.40%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 52.98%\">-8.21%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 49.14%\">7.61%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 47.00%\">7.28%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 45.03%\">-6.98%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 43.43%\">6.73%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 42.91%\">6.65%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 39.60%\">-6.14%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 38.82%\">6.02%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 38.53%\">-5.97%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 36.30%\">5.62%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 35.44%\">5.49%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 34.44%\">5.34%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 30.29%\">4.69%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 30.10%\">-4.66%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 29.93%\">4.64%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 28.69%\">-4.45%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 28.37%\">4.40%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightgreen; width: 25.84%\">-4.00%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: #FF9999; width: 24.75%\">3.83%<\/span>"],["chr1","chr19","chr15","chr12","chr12","chr9","chr19","chr6","chr7","chr1","chr6","chr7","chr8","chr9","chr13","chr1","chr12","chr16","chr8","chr6","chr7","chr5","chr3","chr8","chr11","chr11","chr12","chr11","chr9","chr16","chr17","chr19"],["<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 63.62%\">63.07%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 92.65%\">91.83%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 97.08%\">96.23%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 58.30%\">57.79%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 82.00%\">81.28%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 98.73%\">97.86%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 83.02%\">82.29%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 99.11%\">98.24%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 73.51%\">72.86%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 79.59%\">78.89%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 92.52%\">91.71%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 98.99%\">98.12%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 95.82%\">94.97%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 94.42%\">93.59%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 93.03%\">92.21%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 90.87%\">90.08%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 86.69%\">85.93%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 100.00%\">99.12%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 98.10%\">97.24%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 99.87%\">98.99%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 76.43%\">75.75%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 68.95%\">68.34%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 97.97%\">97.11%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 95.94%\">95.10%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 96.58%\">95.73%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 89.48%\">88.69%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 96.96%\">96.11%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 84.54%\">83.79%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 94.30%\">93.47%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 99.75%\">98.87%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 89.99%\">89.20%<\/span>","<span style=\"display: block; direction: ltr; border-radius: 3px; background-color: lightblue; width: 87.71%\">86.93%<\/span>"],["<a href='images/PSMB4_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL13A_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPLP1_barplot.png' target='_blank'>Link<\/a>","<a href='images/COX6A1_barplot.png' target='_blank'>Link<\/a>","<a href='images/ATP5F1B_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL7A_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL18A_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS18_barplot.png' target='_blank'>Link<\/a>","<a href='images/AGR2_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL5_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS12_barplot.png' target='_blank'>Link<\/a>","<a href='images/PPIA_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS20_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL12_barplot.png' target='_blank'>Link<\/a>","<a href='images/TPT1_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS8_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL6_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS2_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL30_barplot.png' target='_blank'>Link<\/a>","<a href='images/EEF1A1_barplot.png' target='_blank'>Link<\/a>","<a href='images/HSPB1_barplot.png' target='_blank'>Link<\/a>","<a href='images/NPM1_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL32_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL8_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS3_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPLP2_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPLP0_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL27A_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS6_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL13_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPL23_barplot.png' target='_blank'>Link<\/a>","<a href='images/RPS11_barplot.png' target='_blank'>Link<\/a>"],["<a href='images/PSMB4_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL13A_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPLP1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/COX6A1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/ATP5F1B_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL7A_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL18A_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS18_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/AGR2_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL5_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS12_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/PPIA_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS20_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL12_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/TPT1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS8_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL6_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS2_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL30_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/EEF1A1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/HSPB1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/NPM1_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL32_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL8_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS3_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPLP2_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPLP0_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL27A_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS6_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL13_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPL23_pheatmap.png' target='_blank'>Link<\/a>","<a href='images/RPS11_pheatmap.png' target='_blank'>Link<\/a>"],["<a href='images/PSMB4_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL13A_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPLP1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/COX6A1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/ATP5F1B_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL7A_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL18A_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS18_transcripts.png' target='_blank'>Link<\/a>","<a href='images/AGR2_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL5_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS12_transcripts.png' target='_blank'>Link<\/a>","<a href='images/PPIA_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS20_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL12_transcripts.png' target='_blank'>Link<\/a>","<a href='images/TPT1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS8_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL6_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS2_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL30_transcripts.png' target='_blank'>Link<\/a>","<a href='images/EEF1A1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/HSPB1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/NPM1_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL32_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL8_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS3_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPLP2_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPLP0_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL27A_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS6_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL13_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPL23_transcripts.png' target='_blank'>Link<\/a>","<a href='images/RPS11_transcripts.png' target='_blank'>Link<\/a>"]],"container":"<div class='header'><img src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMjYuMzA0IDQzLjIwOSIgaGVpZ2h0PSIxNjMuMzEiIHdpZHRoPSI4NTUuMzIzIj4KICA8cGF0aCBkPSJNMTQ0LjA3OCA5LjU4M2EuMTIxLjEyMSAwIDAwLS4wNjYuMDI3Yy0xLjE0NS45NTUtMi4xNyAyLjA0OS0zLjEzNyAzLjE3NGEuMTIxLjEyMSAwIDAwLS4wMDIuMDAyYy0uODYgMS4wNzktMS44MzcgMi4yNDUtMi4wMzUgMy43MDEtLjA3Mi40NjkuMTEuODgyLjQxIDEuMTc4LjMuMjk2LjcxMi40ODMgMS4xMjUuNTM3LjE3NC4wMjkuMzIuMDA0LjQyOC0uMDY2YS4zNy4zNyAwIDAwLjE3LS4zMDVjMC0uMjI4LS4yMS0uNDM1LS41MzgtLjQ1NS0uNTY2LS4xNjUtLjg5NS0uODAxLS43MTItMS4zNjEuNDk2LTEuNTc1IDEuNjM2LTIuODU3IDIuNzYxLTQuMDY3bC4wMDQtLjAwNmMuNTAxLS40ODEuOTQ2LTEuMDQ3IDEuNDc3LTEuNDEyIDEuMDE3LjQ3OCAxLjk1NSAxLjQ3OCAxLjg5NiAyLjYzOS0uMTYzIDEuMzI1LTEuMjYyIDIuMzAyLTIuMjg1IDMuMTI1LS4xODUuMTEzLS40MjIuMzMtLjYzOC41YTEuOTEgMS45MSAwIDAxLS4yMzcuMTYyYy4yMTYtLjQ4My4zMDktLjkyLjMzLTEuMzU0LjAyNS0uNDktLjAwOS0uOTg3LjA0NS0xLjU5M2EuMTIyLjEyMiAwIDAwLS4yNDItLjAyNGMtLjI3MyAyLjQxOS0xLjY3IDQuNTkyLTMuNSA2LjE2NC0xLjkyOCAxLjI3OC0uOTg0LjYzMi0yLjg4NSAxLjk3YS4xMjEuMTIxIDAgMDAuMTMuMjA0Yy4zODgtLjIxNC41OTUtLjMwOC42OTQtLjM0LjA0OS0uMDE1LjA2OC0uMDEzLjA2NS0uMDEzaC4wMDJjLjAxOC4wMTMuMDU3LjA0LjEwNS4wNDMuMDU0LjAwMi4xLS4wMTEuMTY0LS4wMzcuMTI4LS4wNTIuMzMtLjE2My43MTMtLjM5N2EuMTIxLjEyMSAwIDAwLjAwOC0uMDA2YzEuNzE3LTEuMjQgNC4wNy0xLjQ3MiA2LjAyNi0uNjgzYS4xMjEuMTIxIDAgMDAuMTA1LS4yMTVjLS40ODMtLjI4My0uNjQ1LS40OC0uODUzLS42NDctLjE1Ny0uMTI2LS4zODMtLjIxOC0uNzA1LS4yOTMuNzg1LS40MzcgMS42NDYtLjc4NyAyLjUzMy0uNzU0Ljc4NC4wMiAxLjQzNC41MjcgMS43NTQgMS4yMzUuMTMxLjI4Ni4zNzIuNjI0LjUxMS45NDEuMDcuMTU5LjExMS4zMDkuMTEuNDM2YS40MTQuNDE0IDAgMDEtLjEzNS4zMTJjLTEuNTc3LjUwMi0zLjIyNy45Ni00Ljg2NS43MzNhLjEyMS4xMjEgMCAwMC0uMDA0LS4wMDIgMS4yMTQgMS4yMTQgMCAwMS0uODktLjUzNCAxLjgyNiAxLjgyNiAwIDAxLS4zMDQtMS4wNDMuMTIxLjEyMSAwIDAwLS4wMjUtLjA3NC41MzMuNTMzIDAgMDAtLjIwNS0uMTc0LjMwNy4zMDcgMCAwMC0uMjM0LS4wMDdjLS4xNDMuMDU3LS4yMjIuMTkxLS4yOC4zNDEtLjA1Ny4xNS0uMDg4LjMyNi0uMDkuNDk0IDAgLjE2OS4wMjUuMzMyLjExMi40NmwtLjAyLS4wNDNjLjA4Ny40MTIuMzQxLjcyMi42NTguOTM3LjMxNy4yMTUuNjk4LjMzOCAxLjA2NS4zOWEuMTIxLjEyMSAwIDAwLjAwNC4wMDNjMS40NDEuMTUzIDIuODg2LS4xNTcgNC4yNDgtLjU1YS4xMjEuMTIxIDAgMDAuMDMxLS4wMTNjLjIyMy0uMTM5LjY5NC0uMjAzIDEuMTAyLS4zMTguMjA0LS4wNTguMzk3LS4xMzEuNTQzLS4yNThhLjYxNS42MTUgMCAwMC4yMDMtLjU1My4xMjEuMTIxIDAgMDAwLS4wMDhjLS4yNS0xLjI2NC0uOC0yLjc0NS0yLjE0My0zLjI2NWEuMTIxLjEyMSAwIDAwLS4wMDYtLjAwMmMtMS41NTQtLjUwNi0zLjE0LjI0NS00LjQwMiAxLjA0NWEuMTIxLjEyMSAwIDAwLS4wMTQuMDA4Yy0uMjIyLjE4NC0uNDg2LjI0OC0uNzgxLjI4OS0uMjc2LjAzNy0uNTcyLjA1Ny0uODYzLjE0MmwuMDY0LS4wNThhLjEyMS4xMjEgMCAwMC4wMDItLjAwMmMuNjIyLS41OCAxLjA2OC0xLjI5NyAxLjYzOS0xLjg2IDEuMjQ3LS44NDUgMi41NzItMS42NjQgMy41MjMtMi45MDJsLjAwMi0uMDAyYy4zNi0uNDQ4LjY5My0xLjAwMS44Ni0xLjU5LjE2NS0uNTg2LjE2LTEuMjE0LS4xNjYtMS43ODMtLjQ1NC0uOTk2LTEuMzkyLTEuNjItMi4yOS0yLjEwOGEuMTIxLjEyMSAwIDAwLS4wNy0uMDE1eiIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz4KICA8dGV4dCBzdHlsZT0ibGluZS1oZWlnaHQ6MS4yNTstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidMb2JzdGVyIFR3byciIHg9IjQ0LjM3NyIgeT0iNzAuNDEzIiBmb250LXdlaWdodD0iNDAwIiBmb250LXNpemU9IjEwLjU4MyIgZm9udC1mYW1pbHk9IkxvYnN0ZXIgVHdvIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIiBzdHJva2Utd2lkdGg9Ii4yNjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5LjgxIC05My43NzcpIi8+CiAgPHRleHQgc3R5bGU9ImxpbmUtaGVpZ2h0OjEuMjU7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonTG9ic3RlciBUd28nIiB4PSItMjAuNTcyIiB5PSIxMzMuNjk3IiBmb250LXdlaWdodD0iNDAwIiBmb250LXNpemU9IjEwLjU4MyIgZm9udC1mYW1pbHk9IkxvYnN0ZXIgVHdvIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIiBzdHJva2Utd2lkdGg9Ii4wNyIgc3Ryb2tlLWRhc2hhcnJheT0iLjA3IC4wNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTkuODEgLTkzLjc3NykiPgogICAgPHRzcGFuIHg9Ii0yMC41NzIiIHk9IjEzMy42OTciIHN0eWxlPSItaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidMb2JzdGVyIFR3byciIGZvbnQtc2l6ZT0iNDIuMzMzIj5EVFVydDx0c3BhbiBsZXR0ZXItc3BhY2luZz0iLjI2NSI+bDwvdHNwYW4+ZTwvdHNwYW4+CiAgPC90ZXh0PgogIDxwYXRoIGQ9Ik0yMTQuNjIgNDMuMTljLTEuMzg3LS4yMTYtMi43LTEuMDQ0LTQuMDE1LTIuNTMzLS42OTEtLjc4My0yLjA5LTIuNTgtMy40NDYtNC40MjlsLTEuMDMyLTEuNDA2LS4zNTcuMDQ3Yy0uMTk3LjAyNi0xLjM0LjIyMi0yLjU0LjQzNy0zLjM0Mi41OTctNC42MjguNjk2LTkuODQzLjc2NS00LjIxMy4wNTUtNS45Ny0uMDIyLTguMzEyLS4zNmwtMS41MjUtLjIyLS4yOTUuNDgxYy0yLjgxNCA0LjYwMy0zLjQgNS4yOTctNS4yMSA2LjE2Mi00Ljc3IDIuMjgtMTAuODUtMS4yNi0xMS4xNDYtNi40OTEtLjA4My0xLjQ3NC4yLTIuNiAxLjE0Mi00LjU0My41NjMtMS4xNjIuNTg3LTEuMjMyLjQ0OS0xLjM0LS4zNi0uMjc4LTIuNDY4LTEuMjI2LTMuNDQtMS41NDctMS45NDQtLjY0LTMuODczLTEuMDE4LTcuMTU1LTEuNC0zLjE5Ny0uMzcyLTQuNTc2LS42OTYtNS45NDItMS4zOTgtMi4xMTMtMS4wODYtMy42ODUtMy40NDctNC4wOTItNi4xNDUtLjQwMy0yLjY3My40MDgtNS40MjUgMi4xNzYtNy4zOTEgMS4zNjQtMS41MTUgMy44MTMtMi42MDkgNS44NDYtMi42MSAxLjE4NiAwIDIuNzk1LjM5NSA0LjUwNiAxLjEwNy40MDMuMTY4IDEuNzMyLjc4NiAyLjk1NSAxLjM3NCAyLjcyMyAxLjMwOSAzLjI3OSAxLjU1OCA0LjI3IDEuOTE3bC43OC4yODEuMTIyLS4yOTZjLjMyOS0uNzk2Ljk5OC0yLjExNyAxLjQwMi0yLjc2OSAzLjE5LTUuMTQyIDkuNjAzLTkuMDIyIDE3LjE1OS0xMC4zOCA5LjAxNy0xLjYyMSAxOC43ODUuNzQgMjUuNjM4IDYuMTk5IDEuMDg1Ljg2NCAyLjkxNCAyLjY3OCAzLjcwOCAzLjY3OGEyMC43NiAyMC43NiAwIDAxMy4xOTUgNS43MTFjLjE5OC41NDQuNDUzIDEuMTI5LjU2NiAxLjMuMjAyLjMwNS4yMTIuMzEuNTc1LjI1OCAxLjM3MS0uMTk2IDEuNzItLjIxNSAyLjM0MS0uMTMzLjg4OC4xMTkgMS41LjQzIDIuMDgyIDEuMDU5IDEuMTEzIDEuMjAxIDEuNDMyIDIuODY1LjgwNiA0LjIwMi0uMzc3LjgwNS0yLjg5OSAzLjM2LTQuODYgNC45MjQtLjQzNi4zNDgtLjgwNS42NjUtLjgyLjcwNC0uMDE0LjAzOS4yOTMuNTA5LjY4MyAxLjA0NCAxLjk5NyAyLjc0MSAyLjU5OSAzLjg0NSAyLjg0MyA1LjIxNy4zOTkgMi4yMzMtLjM0NCA0LjQ1NC0yLjAyNyA2LjA2Mi0xLjY5OSAxLjYyMy0zLjU4IDIuNDA0LTUuOTU3IDIuNDcyLS41NDUuMDE1LTEuMDk5LjAxMS0xLjIzLS4wMXptMi4xMi00LjcyMmMuOTU3LS4yMDMgMS45ODUtLjkxNiAyLjMyNi0xLjYxMi4xODUtLjM3Ny4yMS0uNTE0LjE4LS45MzgtLjA0NS0uNTkzLS4yNjMtMS4xODYtLjcxMi0xLjkzLS41MzUtLjg5LTIuMTMtMy4wNS0yLjI1LTMuMDUtLjE2NyAwLS43NzMuMjUtMi43NzUgMS4xNDctMS4wMDQuNDUtMi4wNS44OTgtMi4zMjMuOTk3LS4zMzYuMTIxLS40NzQuMjA4LS40MjguMjY4bDEuMjYzIDEuNjgzYzEuNDAyIDEuODcyIDIuMzIgMi45OTIgMi42MDcgMy4xOC40NzcuMzEyIDEuMzQ3LjQxOCAyLjExMS4yNTV6TTE3NS45OTEgMzhjLjUxNi0uMjIzIDEuMDA4LS43NTQgMS43OTQtMS45NDMuNjctMS4wMTMuODgzLTEuMzcyLjgzMy0xLjQxM2E1Ni42MyA1Ni42MyAwIDAwLTEuNjIzLS42NSAxNzEuNDcxIDE3MS40NzEgMCAwMS00LjI5LTEuNzU2Yy0uMDQ2LS4wMi0uMjcuMzUtLjQ5NS44Mi0xLjAxOCAyLjEyLS44NSAzLjI0OC42NjQgNC40NzcuNzA4LjU3NC44NDkuNjQ0IDEuNDIzLjcuNjI3LjA2MiAxLjE4My0uMDE2IDEuNjk0LS4yMzV6bTE5LjU4LTYuNDNjNS43MzctLjM3MSAxMy40MjUtMS43MDggMTguMDEyLTMuMTMzIDUuOTM3LTEuODQzIDkuMjM3LTQuMDA0IDEwLjY0NS02Ljk2Ny40NzItLjk5NC4zMjQtMS4yODItLjU0NS0xLjA2OC0uODQuMjA4LTEuOTcuNjc4LTYuOTYgMi44OTgtNi4zOTQgMi44NDQtNi40MzkgMi44Ni05LjIwOCAzLjQyMy0zLjQxNy42OTMtNi4zOTcgMS4xMDYtOS4yODcgMS4yODYtMS44NzguMTE3LTYuMS4wNDctNy40NjEtLjEyMy0yLjA0NS0uMjU2LTQuOTQ2LS44NjQtNy42Mi0xLjU5Ni0yLjc2OC0uNzU4LTMuOTc3LTEuMjMzLTcuMDc3LTIuNzc4LTIuMzU2LTEuMTczLTMuODc0LTIuMDQzLTUuNjQ1LTMuMjMxLTEuNDc1LS45OTEtMi42MTQtMS42MDUtMy44Ni0yLjA4LTEuMTM2LS40MzQtMi42NTctMS4wOTgtNC4zODItMS45MTUtMy40MzUtMS42MjYtMy45NC0xLjg1NC00LjUzMi0yLjA1Mi0xLjQ5OC0uNTAyLTMuMTc5LS4yNzItNC4xMDUuNTYtLjc5Ni43MTYtMS4xNTEgMS44NTMtMS4xMDIgMy41MjYuMDI2Ljg4OC4wNTIgMS4wNDIuMjQzIDEuNDI5YTMuNzA5IDMuNzA5IDAgMDAyLjA3MyAxLjg2Yy42NzguMjU2IDEuNTE3LjQwMiAzLjQ2My42IDIuNjQyLjI3MSA1LjI3NC43NTcgNy41MTEgMS4zODggMS43MDUuNDggMi40MzYuODIgNS41NDYgMi41NzggMS43MTguOTcgMi41MzkgMS4zOSAzLjg4IDEuOTgyIDQuMjQxIDEuODcgOS4xOTQgMy4wNSAxNC4yOTcgMy40MDYgMS4zOTguMDk3IDQuNjU2LjEwMSA2LjExMy4wMDd6bS00MC4yMjUtMTMuMzE4Yy0uMTItLjAxNC0uMjE5LS4wNjItLjIxOS0uMTA4IDAtLjA0NS0uMDUzLS4wNjItLjExNy0uMDM3LS4wNy4wMjctLjE1My0uMDItLjIwMy0uMTEzLS4wNDYtLjA4Ny0uMTE4LS4xMzctLjE2LS4xMTEtLjA0MS4wMjUtLjA3NS0uMDEtLjA3NS0uMDhhLjIuMiAwIDAwLS4xMi0uMTcyYy0uMDY1LS4wMjUtLjExOC0uMTMtLjExOC0uMjM1IDAtLjEwNS0uMDMzLS4xOS0uMDc0LS4xOS0uMDk4IDAtLjAzNi0uNzk1LjA3LS45MDFhLjMwNy4zMDcgMCAwMC4wODMtLjE4NmMwLS4xMzUuMjQ5LS40MjEuMzY2LS40MjEuMDUxIDAgLjExNC0uMDU0LjE0LS4xMi4wMjUtLjA2Ni4wNzMtLjExMi4xMDctLjEwMi4wMzQuMDEuMTMzLS4wMi4yMi0uMDY3LjItLjEwNi44MDItLjA3NS45NTIuMDUuMDYyLjA1MS4xNS4wNy4xOTYuMDQyLjA0Ni0uMDI5LjEwNS4wMDQuMTMxLjA3Mi4wMjcuMDY5LjA5OC4xMjQuMTU5LjEyNC4wNiAwIC4xMS4wNTUuMTEuMTIycy4wNTYuMTQzLjEyNC4xNjljLjA2OC4wMjYuMTA2LjA5NC4wODQuMTUtLjAyMi4wNTcuMDA2LjE0MS4wNjEuMTg3LjEyMi4xMDEuMDk4Ljk4My0uMDI3IDEuMDI1LS4wNDYuMDE1LS4wODMuMDkyLS4wODMuMTcxIDAgLjA4LS4wNTQuMTY0LS4xMi4xOWEuMTk2LjE5NiAwIDAwLS4xMTguMTY3YzAgLjA3LS4wNy4xMjEtLjE2NC4xMjEtLjA5IDAtLjE0LjAzNi0uMTE0LjA4LjAyOC4wNDUtLjAzOS4wOC0uMTU0LjA4LS4xMTIgMC0uMjAzLjAyOC0uMjAzLjA2MyAwIC4wNjMtLjMyNy4wNzctLjczNC4wM3ptNDMuNTEgNS4zNDdjMS4xMS0uMDI3IDIuMDM4LS4wNjIgMi4wNjQtLjA3Ny4wMjUtLjAxNS4zNjgtLjA1MS43Ni0uMDguODUyLS4wNjUgMi4wNjUtLjE5IDIuMzQyLS4yNDMuMTEtLjAyLjMwNi0uMDU0LjQzNy0uMDc1LjEzMS0uMDIuNzkyLS4xMjcgMS40NjgtLjIzNy42NzctLjExIDEuMzc0LS4yMjEgMS41NDgtLjI0OCAyLjI0OS0uMzQyIDQuOTE0LTEuMjc0IDYuMjMxLTIuMTguMTktLjEzLjU4Ny0uMzUgMS45MDUtMS4wNTMuMzI4LS4xNzUuNjA0LS4zMjQuNjE1LS4zMzMuMDQ3LS4wMzYtMS4yNC0yLjUzMy0xLjY5OC0zLjI5Ni0xLjI5NC0yLjE1My0xLjUyNC0yLjQ4NC0yLjMyNC0zLjM1LS40NTUtLjQ5NC0xLjExNi0xLjIxMS0xLjQ2OC0xLjU5Ni0uNDY4LS41MS0uODI0LS44MDgtMS4zMTYtMS4xMDRhNDEuMjM0IDQxLjIzNCAwIDAxLTEuMzUtLjg1NWMtLjkzMi0uNjIxLTUuNDYzLTIuODktNi4xMTEtMy4wNmE4MS40MjggODEuNDI4IDAgMDEtMS4xNTEtLjM1MWMtMS4xNzktLjM2NS0xLjYwMy0uNDQ4LTIuNjYtLjUyMy0uNDE0LS4wMjktLjc3MS0uMDYzLS43OTMtLjA3NS0uMDIyLS4wMTItLjQxNS0uMDQ4LS44NzMtLjA4LS40NTktLjAzLS44NTEtLjA2Ny0uODczLS4wOC0uMDUtLjAzLTIuODY4LS4xNDktMy41NzItLjE1Mi0uNjczLS4wMDMtMi44OTguMTA5LTMuMjU1LjE2My0uMjU3LjAzOS0xLjk4My41MDYtMi44OTcuNzg0LTMuOTQ2IDEuMi00LjUyOCAxLjQxLTUuNTA2IDEuOTc2LS40OTcuMjg5LS45MTMuNTI0LS45MjQuNTI0LS4wMSAwLS40MzMuMjQxLS45MzkuNTM2LS43OTcuNDY1LTEuMTUyLjc1LTIuNjczIDIuMTU1LS45NjQuODktMS44NTMgMS43NjUtMS45NzUgMS45NDUtLjQ0NS42NTUtLjg2NSAxLjcyNC0xLjA4MSAyLjc1My0uMTc1LjgzMi0uMTg0LjgwOS40NTggMS4xODcuMzE2LjE4Ny43OS40NzEgMS4wNTIuNjMyLjI2MS4xNjIgMS4xLjY2MSAxLjg2NSAxLjExLjc2NC40NSAxLjUyMi45MDIgMS42ODUgMS4wMDUuMTYzLjEwMy41NzQuMjk3LjkxMy40MzIuMzQuMTM1LjY1Mi4yNzIuNjk2LjMwNS4wOTkuMDc0IDEuNzkzLjc0NyAyLjIyMi44ODIuMTc1LjA1NS40Ni4xNDcuNjM1LjIwNS44NS4yOCAzLjM0My45OTIgMy45NzMgMS4xMzVhMjYxLjI0OCAyNjEuMjQ4IDAgMDEyLjI5OC41MzJjLjA4Ny4wMi41NTIuMDkgMS4wMzIuMTUzYTI1NC4zMiAyNTQuMzIgMCAwMTEuNzA2LjIzM2MuMTk3LjAyNy40NDcuMDYzLjU1Ni4wOC40ODUuMDc1IDIuMjIzLjIzNCAzLjU3Mi4zMjUuNDE1LjAyOC43NjUuMDYuNzc4LjA3Mi4wMTMuMDEyLjE1Ni4wMS4zMTgtLjAwM2ExMDEuMTIgMTAxLjEyIDAgMDEyLjMxLS4wNzN6bTYuOTEyLTIuNjE5Yy0uODQ3LS4yODMtMS4wODItLjM5NS0xLjg0Mi0uODg1LTEuMDc3LS42OTMtMi4yMzUtMS45OTUtMi44MzMtMy4xODctLjA5My0uMTg1LS4yMTMtLjMzNy0uMjY3LS4zMzYtLjA1NCAwLS40OS4zNTgtLjk3Ljc5Ni0xLjg0NyAxLjY4Mi0zLjM2NCAyLjQ1NC01LjA4MiAyLjU4Ny0xLjE3LjA5LTIuNDgyLS4yNTgtMy41My0uOTM4LS41OTMtLjM4NC0xLjcxNS0xLjQ4LTIuNDY0LTIuNDA3LS4yOTgtLjM2OC0uNjM2LS42OTQtLjgwMy0uNzc2LS4yNzItLjEzMy0uMzEtLjEzNC0uNjE1LS4wMTEtLjE4LjA3MS0uNzc4LjQ4LTEuMzMuOTA5LTEuNTk2IDEuMjQtMi45NzIgMS44MjMtNC4zMDIgMS44MjMtLjk1OCAwLTEuNTUtLjM5OS0xLjM2LS45MTYuMS0uMjY4LjI2NC0uMzUgMS4wNC0uNTE3IDEuMTYtLjI1IDEuMjUtLjM1NCAxLjU0Ny0xLjgxMi4yNTUtMS4yNTcuNDItMi43My40OC00LjNsLjA1MS0xLjMxNi0uNjUzLS4yN2MtMS4wNy0uNDQxLTEuNDY4LS45MjYtMS4yMy0xLjQ5NS4xNjctLjM5NS41My0uNTEzIDEuMTE3LS4zNjMuNjA5LjE1NSAxLjgxNy43MzggMi4zNDYgMS4xMzIuNDcyLjM1MSAxLjI0OSAxLjE1IDIuMTExIDIuMTczLjMxOS4zNzcuNzA1Ljc4Mi44Ni45bC4yNzkuMjEzLjI3NC0uMTk1Yy4xNS0uMTA3LjYzNi0uNTI2IDEuMDc4LS45MzEgMS42NjItMS41MiAzLjE3NS0yLjIyIDQuODE2LTIuMjIzIDEuNjg2LS4wMDQgMy4wOTQuODMgNS4yODcgMy4xMy42OS43MjIgMS4yOTQgMS4zMTMgMS4zNDQgMS4zMTMuMDUgMCAuNTItLjMyNCAxLjA0Mi0uNzIgMi4xMjYtMS42MSAzLjM0Mi0yLjEzMyA0Ljk3NC0yLjEzNi43OTEtLjAwMiAxLjAzNS4wNjkgMS4yMi4zNTMuMTE0LjE3Mi4xMTguMjM4LjAzMy40NDQtLjEyMS4yOTQtLjM4LjQzNS0xLjA4Ni41OTQtLjg0Ni4xOS0uOTY1LjI1Ni0xLjA1LjU4Mi0uMjEzLjgwNi0uNjEyIDQuMDQ5LS42ODQgNS41NjYtLjA2IDEuMjU3LS4wMjUgMS4zMjMuOTc4IDEuODU2LjM5Ni4yMS43OTguNDY2Ljg5NC41NjguMjM0LjI1LjE2LjUyOC0uMTk4Ljc1LS41MDcuMzEzLS42NTcuMzE4LTEuNDcyLjA0NXpNMTk0LjY5MiAxOGMuMi0uMi40NzItMS45MS43NTctNC43Ni4xNzktMS43OS4yMDItMi42MzQuMDc5LTIuODY1LS4wNzMtLjEzNi0uMTczLS4xNTMtLjg4LS4xNTMtLjc2OSAwLS44MDUuMDA4LTEuMDIxLjIyNGExLjQ3IDEuNDcgMCAwMC0uMzE0LjUzNmMtLjI1Mi44ODItLjY1NSA0LjA3LS43NzEgNi4xMDYtLjA1Mi45MDYtLjA1MS45MDkuMTM5Ljk4OC4zMDQuMTI4IDEuODY3LjA2OCAyLjAxMS0uMDc2em05LjEzNy0uODNjLjEyNy0uMzA1LjM4OS0yLjI0NC40NzQtMy41MTUuMDYtLjg4MS4wNDgtLjkwNS0uMzUtLjctLjM1NC4xODQtMS4zNzcgMS4zMjQtMS42MjIgMS44MDgtLjIwNi40MDktLjIxNi40Ny0uMTMuNzg4LjE4OS43MDEuNjkyIDEuNDcgMS4xNDMgMS43NDUuMzI2LjE5OS4zNTIuMTkyLjQ4NS0uMTI3em0tNS45MzgtLjE2N2MuNzg5LS4zOTIgMS43NjQtMS42NjIgMS43NjYtMi4yOTkuMDAyLS40OC0xLjA3LTIuMzctMS42NjUtMi45MzQtLjIzNC0uMjIzLS4yNTgtLjIzLS4zNTQtLjA5OC0uMjM2LjMyLS42NjIgMi45MjMtLjczNCA0LjQ4M2wtLjA0OCAxLjA1MmguMzE0Yy4xNzcgMCAuNDktLjA4OC43MjEtLjIwNHptLTYuODk1LS45MTJjLjA4LS4yMjguMjY1LTIuMDcuMzYtMy41NjcuMDU3LS44ODcuMDAyLS45Ny0uNDQzLS42NzctLjU2NC4zNy0xLjMgMS4xNzItMS40NTkgMS41ODktLjEyNC4zMjQtLjEzMS40MzctLjA1My44MTEuMTE0LjU0LjU3IDEuMzcuOTc5IDEuNzc4LjM3Mi4zNzIuNTA0LjM4Ni42MTYuMDY2em0tNS4xOTYtMS4yMjdjLjU2LS41MzQgMS0xLjE2NSAxLTEuNDM3IDAtLjM5LTEuMjYzLTIuNDU0LTEuNTYtMi41NDgtLjA0OC0uMDE2LS4xMTIuMDkzLS4xNC4yNDMtLjA4OS40NzMtLjI4MyAzLjA3OC0uMjg0IDMuODA3bC0uMDAxLjcuMjQtLjE0MmMuMTMtLjA3OC40NjYtLjM1OC43NDUtLjYyM3oiLz4KPC9zdmc+Cg==\" /><div class='txt'><h2 align='center' data-toc-skip>Dex2hr vs. EtOH (399 vs.\n                      397)<\/h2><h4 align='center' data-toc-skip>Significant differential genes: 32<br>Significant differential transcripts: 37<\/h4><\/div><\/div><table>\n  <thead>\n    <tr>\n      <th>gene_ID<\/th>\n      <th>gene_qvalue<\/th>\n      <th>minimal_tx_qvalue<\/th>\n      <th>number_tx<\/th>\n      <th>number_significant_tx<\/th>\n      <th>max(Dex2hr-EtOH)<\/th>\n      <th>chromosome<\/th>\n      <th>tx_expr_in_max<\/th>\n      <th>barplot<\/th>\n      <th>pheatmap<\/th>\n      <th>transcript_view<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","orderClasses":true,"buttons":[{"extend":"collection","buttons":["csv","excel"],"text":"Download"}],"autoWidth":true,"pageLength":10,"lengthMenu":[10,25,32],"columnDefs":[{"targets":"_all","render":"function(data, type, row, meta) {\n                              if (type == 'display') {\n                                return data;\n                              } else if (type == 'filter' || type == 'type'){\n                                var new_dat = String(data).replace(/<.*?>/g, '').replace(/%/g, '')\n                                if(new_dat !== '' && !isNaN(Number(new_dat))){\n                                  console.log(data);\n                                  console.log(type);\n                                  console.log(new_dat);\n                                  return Number(new_dat);\n                                }else{\n                                  return new_dat;\n                                }\n                              } else if (type == 'sort'){\n                                var new_dat = String(data).replace(/<.*?>/g, '').replace(/%/g, '')\n                                if(new_dat !== '' && !isNaN(Number(new_dat))){\n                                  return Math.abs(Number(new_dat));\n                                }else{\n                                return new_dat;\n                                }\n                              }\n                            }"},{"className":"dt-right","targets":[2,3,4]}],"initComplete":"function(settings, json) {\nfunction addStyleString(str) {\nvar node = document.createElement('style');\nnode.innerHTML = str\ndocument.body.appendChild(node);\n}\naddStyleString('td { padding: 5px 7px !important; max-width: 200px; text-align: center;}');\naddStyleString('.datatables { margin-left: auto; margin-right: auto;}');\naddStyleString('.dt-buttons { margin-left: 50px;}');\naddStyleString('.header img { float: left; max-width: 25%; min-width: 150px;}');\naddStyleString('.header .txt { display: flow-root; padding-right: 15%;}');\naddStyleString('.header h2 { font-weight: 900; margin: auto; padding: initial;}');\naddStyleString('.header h4 { margin: auto; padding: initial;}');\naddStyleString('#DTUrtle_table-FtdPtHOxhNqnUEH { font-size: 120%;}');\n}","order":[],"orderCellsTop":true}},"evals":["options.columnDefs.0.render","options.initComplete"],"jsHooks":[]}</script>
</div>
<hr>
</div>
</div>
<div id="workflow-with-seurat-object" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow-with-seurat-object" class="anchor"></a>Workflow with Seurat object</h2>
<p>Some users might already have analyzed their (gene-level) single-cell data and performed clustering, dimensional reduction etc. For these users, <em>DTUrtle</em> offers direct support for <em>Seurat</em> objects (Seurat V3 or newer).</p>
<div id="seurat-object-creation" class="section level3">
<h3 class="hasAnchor">
<a href="#seurat-object-creation" class="anchor"></a>Seurat object creation</h3>
<p>For this tutorial, we will create a <em>Seurat</em> object on the fly - users with an already existing object might want to directly jump to the second step.</p>
<p>We create a <em>Seurat</em> object on the gene-level counts, using the <em>DTUrtle</em> functionality <code><a href="../reference/summarize_to_gene.html">summarize_to_gene()</a></code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op">)</span>

<span class="co">#summarize counts to gene-level</span>
<span class="va">cts_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarize_to_gene.html">summarize_to_gene</a></span><span class="op">(</span><span class="va">cts</span>, tx2gene <span class="op">=</span> <span class="va">tx2gene</span>, fun <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span>

<span class="co">##compare dimensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cts</span><span class="op">)</span>
<span class="co">#&gt; [1] 77347   796</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cts_gene</span><span class="op">)</span>
<span class="co">#&gt; [1] 18412   796</span></pre></div>
<p>We use these gene level counts for a standard <em>Seurat</em> analysis (Normalization + Scaling, PCA, Clustering, UMAP).</p>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/CreateSeuratObject.html">CreateSeuratObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">cts_gene</span>, meta.data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>row.names<span class="op">=</span><span class="va">pd</span><span class="op">$</span><span class="va">id</span>, <span class="st">"group"</span><span class="op">=</span><span class="va">pd</span><span class="op">$</span><span class="va">group</span>, stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span>
<span class="co">#&gt; ('-')</span>

<span class="co">#check if names are kept</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/Cells.html">Cells</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">pd</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="co">#run basic pipeline</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/NormalizeData.html">NormalizeData</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op">(</span><span class="va">seur_obj</span>, selection.method <span class="op">=</span> <span class="st">"vst"</span>, nfeatures <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/ScaleData.html">ScaleData</a></span><span class="op">(</span><span class="va">seur_obj</span>, model.use <span class="op">=</span> <span class="st">"negbinom"</span><span class="op">)</span>
<span class="co">#&gt; Centering and scaling data matrix</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunPCA.html">RunPCA</a></span><span class="op">(</span><span class="va">seur_obj</span>, seed.use <span class="op">=</span> <span class="fl">42</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">seur_obj</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; PC_ 1 </span>
<span class="co">#&gt; Positive:  RPL7A, RPS3A, PPIA, RPSA, RPL13, RPS10, RPL6, RPS17, KRT19, TUBA1B </span>
<span class="co">#&gt;     KRT18, EEF1G, AGR2, C1QBP, UBB, GAGE12F, NME1-NME2, PRDX1, SNRPD3, PPIB </span>
<span class="co">#&gt;     SERPINA6, ARL6IP1, GSTM3, NQO1, TP53I3, PIP, C15orf65, GNG11, LRRC59, UBE2C </span>
<span class="co">#&gt; Negative:  RPL6P27, AC091153.3, PNMT, BBS9, DHX58, PCLO, ZNF629, STIM1, AL031058.1, SAMD4A </span>
<span class="co">#&gt;     RAB28, SVIL, LINC02163, FOXP1, PRELID2, RBM38, ARHGEF16, AF235103.3, XYLB, KIFC3 </span>
<span class="co">#&gt;     ZNF248, TMEM229B, FUT1, MAPK15, AC131009.3, KDM3A, ARNTL, TMEM17, CHPF2, CIART </span>
<span class="co">#&gt; PC_ 2 </span>
<span class="co">#&gt; Positive:  RBAK, AL049840.6, HMGCS2, JUNB, RAD51B, INO80D, MAN1B1-DT, CAMKK1, ELF2, CSRNP2 </span>
<span class="co">#&gt;     F3, ELMOD3, AC011445.2, AC090809.1, AC012073.1, DNAJC27-AS1, PPP2CB, PARD3, LRFN1, ASXL2 </span>
<span class="co">#&gt;     ZNF345, LINC01205, AL845472.2, BX470102.2, RALY-AS1, CARD10, LINC00664, AC022784.1, HEATR5B, ID1 </span>
<span class="co">#&gt; Negative:  DNMT3B, SBF2, SRP14-AS1, TNFAIP2, AC104667.2, AC022784.5, TFCP2, RPL13P12, C17orf75, KPNA3 </span>
<span class="co">#&gt;     UBFD1, PGR, CC2D1A, ZNF131, RBM47, FOXRED2, ZBTB5, RPRD2, ZNF239, FDXACB1 </span>
<span class="co">#&gt;     LTV1, ALDH1A3, MYO1F, CEP55, ADAT1, GLUL, UBE3C, CCDC43, IGSF5, VWA5A </span>
<span class="co">#&gt; PC_ 3 </span>
<span class="co">#&gt; Positive:  NME1-NME2, PSMD7, PIP, AC116036.2, EEF1G, ZNF197, C19orf53, PRDX1, KRT18, KRT19 </span>
<span class="co">#&gt;     ZCRB1, RPS10-NUDT3, LENG1, NADSYN1, PLOD3, GAGE12J, RPSA, LINC01089, PRDM11, AL358472.2 </span>
<span class="co">#&gt;     SETD4, TAC3, CCNB1, PPM1J, BMP1, MCM7, FASTKD3, RPL13, MFHAS1, DAGLB </span>
<span class="co">#&gt; Negative:  H1-0, DNAJB4, SLC16A9, LINC01446, ZDHHC9, ZFYVE26, FAM210B, DDX21, MIS18A, ZNF131 </span>
<span class="co">#&gt;     KLHL18, ADAT1, UBE3C, GORAB, RNF103, SLC26A11, DDI2, BTN2A2, TMEM87A, TAF1C </span>
<span class="co">#&gt;     ARHGAP11A, MRPS35, EYA3, LINC01311, ZNF492, MT2A, LPAR1, DHFR2, UBFD1, FOXRED2 </span>
<span class="co">#&gt; PC_ 4 </span>
<span class="co">#&gt; Positive:  C15orf65, SRP14-AS1, TNFAIP2, BX890604.2, DNMT3B, EPHX1, AC022784.5, C17orf75, ALKBH2, DCAF12 </span>
<span class="co">#&gt;     EML4, AC104667.2, TSPAN12, BICD2, MTATP6P1, C9orf85, CHST15, ASMTL, TBILA, ARVCF </span>
<span class="co">#&gt;     MREG, RGS12, PIP5K1C, ABCC1, ZNF702P, PLAAT2, SRGN, LRRC59, BMP1, RIC8B </span>
<span class="co">#&gt; Negative:  PANK2-AS1, RAB20, MT1X, AKR1A1, ZNF37BP, MX1, NOL6, LIPT2, TJP1, CLIC3 </span>
<span class="co">#&gt;     EXOC1, SLC15A3, COMMD2, ELMO3, PNPLA3, FAM122A, RIPK2, TRMT2A, AC005332.4, CYP2U1 </span>
<span class="co">#&gt;     OSBPL3, KIF16B, AC132872.1, KIAA1211L, ARSD, TBC1D10A, AC245033.1, PRDX1, SPATA13, AL356277.3 </span>
<span class="co">#&gt; PC_ 5 </span>
<span class="co">#&gt; Positive:  DCAF7, PPP4R4, IGFBP5, GOPC, RAB7A, PTPN14, ANLN, CLPTM1L, CYP2B7P, YAP1 </span>
<span class="co">#&gt;     FAM120A, ACIN1, ZIC2, GRHL2, ALOXE3, SOAT1, TPH1, SLC2A6, PDCD4, HLCS </span>
<span class="co">#&gt;     XXYLT1, NIPSNAP2, ARHGAP11A, OTUB2, TXNIP, RACGAP1, ATR, ERO1B, KIF14, SLC5A3 </span>
<span class="co">#&gt; Negative:  KRT18, AC027682.6, AC129926.1, KRT19, PPIA, RPL17-C18orf32, METTL4, NUDT14, CCDC97, TYMP </span>
<span class="co">#&gt;     CDIP1, FBXO2, RAB19, CCNJ, HSD17B8, GRAMD2B, NME1-NME2, PMS2P4, C1GALT1C1, RASSF8-AS1 </span>
<span class="co">#&gt;     AC010913.1, GLIS2, SPR, IFNGR1, FASTKD2, ENPP4, ZNF696, PANK2-AS1, NME4, EFCAB2</span>

<span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/ElbowPlot.html">ElbowPlot</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-36-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit">

<span class="co">#7 PCs seem like a reasonable cut-off</span>
<span class="va">dims</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>

<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FindNeighbors.html">FindNeighbors</a></span><span class="op">(</span><span class="va">seur_obj</span>, dims <span class="op">=</span> <span class="va">dims</span>, k.param<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; Computing nearest neighbor graph</span>
<span class="co">#&gt; Computing SNN</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FindClusters.html">FindClusters</a></span><span class="op">(</span><span class="va">seur_obj</span>, resolution <span class="op">=</span> <span class="fl">0.7</span>, n.start<span class="op">=</span><span class="fl">100</span>, n.iter<span class="op">=</span><span class="fl">100</span>, random.seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span>
<span class="co">#&gt; Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of nodes: 796</span>
<span class="co">#&gt; Number of edges: 11143</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running Louvain algorithm...</span>
<span class="co">#&gt; Maximum modularity in 100 random starts: 0.7644</span>
<span class="co">#&gt; Number of communities: 6</span>
<span class="co">#&gt; Elapsed time: 0 seconds</span>
<span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/RunUMAP.html">RunUMAP</a></span><span class="op">(</span><span class="va">seur_obj</span>, dims <span class="op">=</span> <span class="va">dims</span>, n.epochs<span class="op">=</span><span class="fl">1000</span>, seed.use<span class="op">=</span><span class="fl">42</span>, umap.method <span class="op">=</span> <span class="st">"umap-learn"</span><span class="op">)</span></pre></div>
<p>The computed UMAP coordinates look like this:</p>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/DimPlot.html">DimPlot</a></span><span class="op">(</span><span class="va">seur_obj</span>, reduction <span class="op">=</span> <span class="st">"umap"</span>, group.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seurat_clusters"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-37-1.png" width="80%" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="seurat-usage-with-dturtle" class="section level3">
<h3 class="hasAnchor">
<a href="#seurat-usage-with-dturtle" class="anchor"></a>Seurat usage with DTUrtle</h3>
<p><em>Seurat</em> objects can be utilized in two parts of the DTUrtle workflow: <code><a href="../reference/combine_to_matrix.html">combine_to_matrix()</a></code> and <code>run_umap()</code>.</p>
<p>To better highlight the functionality, lets assume we only want to perform a DTU analysis in one of the identified cell clusters - Cluster 4.</p>
<p>We subset the <em>Seurat</em> object to this cluster only:</p>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="va">seur_obj_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/subset.Seurat.html">subset</a></span><span class="op">(</span><span class="va">seur_obj</span>, subset <span class="op">=</span> <span class="va">seurat_clusters</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">seur_obj_sub</span><span class="op">)</span>
<span class="co">#&gt; [1] 18412   103</span></pre></div>
<p>We can provide this subsetted <em>Seurat</em> object as a parameter in <code><a href="../reference/combine_to_matrix.html">combine_to_matrix()</a></code>. <em>DTUrtle</em> will try to auto-detect cell name extensions and will subset the count matrix to the cells from the <em>Seurat</em> object. Additionally we can provide a <code>tx2gene</code> data frame, which will be added as feature-level metadata to the <em>Seurat</em> assay.</p>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="va">seur_obj_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_to_matrix.html">combine_to_matrix</a></span><span class="op">(</span>tx_list <span class="op">=</span> <span class="va">cts_list</span>, seurat_obj <span class="op">=</span> <span class="va">seur_obj_sub</span>, tx2gene <span class="op">=</span> <span class="va">tx2gene</span><span class="op">)</span>
<span class="co">#&gt; Merging matrices</span>
<span class="co">#&gt; Of 796 cells, 103 (13%) could be found in the provided seurat object.</span>
<span class="co">#&gt; 693 (87%) are unique to the transcriptomic files.</span>
<span class="co">#&gt; The seurat object contains 0 additional cells.</span>
<span class="co">#&gt; Subsetting!</span>
<span class="co">#&gt; Excluding 172918 overall not expressed features.</span>
<span class="co">#&gt; 54283 features left.</span>
<span class="co">#&gt; Adding assay 'dtutx'</span></pre></div>
<p>The transcript level expression of the 103 cells have been carried over to the <em>Seurat</em> object in an own assay.</p>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="va">seur_obj_sub</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">dtutx</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt; 4 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                TGAATTCAGACTAGTCTG CGGCGTCTTACGTTCTTG TCGGGACCTCTAGAGTGA</span>
<span class="co">#&gt; AL627309.1-201                  .                  .                  .</span>
<span class="co">#&gt; CICP27-201                      .                  .                  .</span>
<span class="co">#&gt; AL627309.6-201                  .                  .                  .</span>
<span class="co">#&gt; AL627309.5-206                  .                  .                  .</span>
<span class="co">#&gt;                AACGTGTCCAAGTTGCTC</span>
<span class="co">#&gt; AL627309.1-201                  .</span>
<span class="co">#&gt; CICP27-201                      .</span>
<span class="co">#&gt; AL627309.6-201                  .</span>
<span class="co">#&gt; AL627309.5-206                  .</span>
<span class="va">seur_obj_sub</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">dtutx</span><span class="op">@</span><span class="va">meta.features</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span>
<span class="co">#&gt;                transcript_name  gene_name seqnames  start    end width strand</span>
<span class="co">#&gt; AL627309.1-201  AL627309.1-201 AL627309.1     chr1  89295 120932 31638      -</span>
<span class="co">#&gt; CICP27-201          CICP27-201     CICP27     chr1 131025 134836  3812      +</span>
<span class="co">#&gt; AL627309.6-201  AL627309.6-201 AL627309.6     chr1 135141 135895   755      -</span>
<span class="co">#&gt; AL627309.5-206  AL627309.5-206 AL627309.5     chr1 167129 169240  2112      -</span>
<span class="co">#&gt;                source       type score phase           gene_id</span>
<span class="co">#&gt; AL627309.1-201 HAVANA transcript    NA    NA ENSG00000238009.6</span>
<span class="co">#&gt; CICP27-201     HAVANA transcript    NA    NA ENSG00000233750.3</span>
<span class="co">#&gt; AL627309.6-201 HAVANA transcript    NA    NA ENSG00000268903.1</span>
<span class="co">#&gt; AL627309.5-206 HAVANA transcript    NA    NA ENSG00000241860.7</span>
<span class="co">#&gt;                           gene_type level    hgnc_id          havana_gene</span>
<span class="co">#&gt; AL627309.1-201               lncRNA     2       &lt;NA&gt; OTTHUMG00000001096.1</span>
<span class="co">#&gt; CICP27-201     processed_pseudogene     1 HGNC:48835 OTTHUMG00000001257.1</span>
<span class="co">#&gt; AL627309.6-201 processed_pseudogene     2       &lt;NA&gt; OTTHUMG00000182518.1</span>
<span class="co">#&gt; AL627309.5-206               lncRNA     2       &lt;NA&gt; OTTHUMG00000002480.1</span>
<span class="co">#&gt;                    transcript_id      transcript_type transcript_support_level</span>
<span class="co">#&gt; AL627309.1-201 ENST00000466430.5               lncRNA                        5</span>
<span class="co">#&gt; CICP27-201     ENST00000442987.3 processed_pseudogene                       NA</span>
<span class="co">#&gt; AL627309.6-201 ENST00000494149.2 processed_pseudogene                       NA</span>
<span class="co">#&gt; AL627309.5-206 ENST00000655252.1               lncRNA                     &lt;NA&gt;</span>
<span class="co">#&gt;                   tag    havana_transcript exon_number exon_id         ont</span>
<span class="co">#&gt; AL627309.1-201  basic OTTHUMT00000003225.1        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; CICP27-201      basic OTTHUMT00000003691.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000004</span>
<span class="co">#&gt; AL627309.6-201  basic OTTHUMT00000461982.1        &lt;NA&gt;    &lt;NA&gt; PGO:0000004</span>
<span class="co">#&gt; AL627309.5-206 TAGENE OTTHUMT00000528579.1        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt;                protein_id ccdsid</span>
<span class="co">#&gt; AL627309.1-201       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; CICP27-201           &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; AL627309.6-201       &lt;NA&gt;   &lt;NA&gt;</span>
<span class="co">#&gt; AL627309.5-206       &lt;NA&gt;   &lt;NA&gt;</span></pre></div>
<p><em>Seurat</em> functions can be used for visualizing expression of single transcripts:</p>
<div class="sourceCode" id="cb42"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/Seurat/man/FeaturePlot.html">FeaturePlot</a></span><span class="op">(</span><span class="va">seur_obj_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PPIA-204"</span>, <span class="st">"PPIA-209"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="Hoffman_human_single-cell_analysis_files/figure-html/unnamed-chunk-41-1.png" width="80%" style="display: block; margin: auto;"></p>
<hr>
<p>The enhanced <em>Seurat</em> object can be used in the actual DTU analysis, if we provide it to the <em>DTUrtle</em> function <code><a href="../reference/run_drimseq.html">run_drimseq()</a></code>. As the <code>tx2gene</code> information was already added in the <code><a href="../reference/combine_to_matrix.html">combine_to_matrix()</a></code> step, we only need to provide the column names of the transcript and gene identifier columns of the feature level metadata. Everything we need for the analysis is present in the <em>Seurat</em> object:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">dturtle_sub &lt;-<span class="st"> </span><span class="kw">run_drimseq</span>(<span class="dt">counts =</span> seur_obj_sub, <span class="dt">pd =</span> seur_obj_sub<span class="op">@</span>meta.data,</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">                           <span class="dt">tx2gene =</span> <span class="kw">c</span>(<span class="st">"transcript_name"</span>, <span class="st">"gene_name"</span>),</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">                           <span class="dt">cond_col=</span><span class="st">"group"</span>, <span class="dt">cond_levels =</span> <span class="kw">c</span>(<span class="st">"Dex2hr"</span>, <span class="st">"EtOH"</span>), </a>
<a class="sourceLine" id="cb43-4" data-line-number="4">                           <span class="dt">filtering_strategy =</span> <span class="st">"sc"</span>, <span class="dt">BPPARAM =</span> biocpar)</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="co">#&gt; Using tx2gene columns:</span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="co">#&gt;  transcript_name ---&gt; 'feature_id'</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co">#&gt;  gene_name ---&gt; 'gene_id'</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="co">#&gt; Comparing Dex2hr vs EtOH</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"><span class="co">#&gt; Proceed with cells/samples: </span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="co">#&gt; Dex2hr   EtOH </span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="co">#&gt;     68     35</span></a>
<a class="sourceLine" id="cb43-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15"><span class="co">#&gt; Filtering...</span></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb43-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-18" data-line-number="18"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb43-19" data-line-number="19">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-20" data-line-number="20"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb43-21" data-line-number="21">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-22" data-line-number="22"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb43-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-24" data-line-number="24"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb43-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-26" data-line-number="26"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb43-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-28" data-line-number="28"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb43-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-30" data-line-number="30"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb43-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-32" data-line-number="32"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb43-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-34" data-line-number="34"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb43-35" data-line-number="35">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-36" data-line-number="36"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb43-37" data-line-number="37">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb43-38" data-line-number="38"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb43-39" data-line-number="39"><span class="co">#&gt; Retain 35301 of 54283 features.</span></a>
<a class="sourceLine" id="cb43-40" data-line-number="40"><span class="co">#&gt; Removed 18982 features.</span></a>
<a class="sourceLine" id="cb43-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb43-42" data-line-number="42"><span class="co">#&gt; Performing statistical tests...</span></a>
<a class="sourceLine" id="cb43-43" data-line-number="43"><span class="co">#&gt; * Calculating mean gene expression..</span></a>
<a class="sourceLine" id="cb43-44" data-line-number="44"><span class="co">#&gt; Took 0.5334 seconds.</span></a>
<a class="sourceLine" id="cb43-45" data-line-number="45"><span class="co">#&gt; * Estimating common precision..</span></a>
<a class="sourceLine" id="cb43-46" data-line-number="46"><span class="co">#&gt; Took 1.7352 seconds.</span></a>
<a class="sourceLine" id="cb43-47" data-line-number="47"><span class="co">#&gt; ! Using common_precision = 778.5341 as prec_init !</span></a>
<a class="sourceLine" id="cb43-48" data-line-number="48"><span class="co">#&gt; * Estimating genewise precision..</span></a>
<a class="sourceLine" id="cb43-49" data-line-number="49"><span class="co">#&gt; ! Using loess fit as a shrinkage factor !</span></a>
<a class="sourceLine" id="cb43-50" data-line-number="50"><span class="co">#&gt; Took 5.9458 seconds.</span></a>
<a class="sourceLine" id="cb43-51" data-line-number="51"><span class="co">#&gt; * Fitting the DM model..</span></a>
<a class="sourceLine" id="cb43-52" data-line-number="52"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb43-53" data-line-number="53"><span class="co">#&gt; Took 7.7136 seconds.</span></a>
<a class="sourceLine" id="cb43-54" data-line-number="54"><span class="co">#&gt; * Fitting the BB model..</span></a>
<a class="sourceLine" id="cb43-55" data-line-number="55"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb43-56" data-line-number="56"><span class="co">#&gt; Took 3.7797 seconds.</span></a>
<a class="sourceLine" id="cb43-57" data-line-number="57"><span class="co">#&gt; * Fitting the DM model..</span></a>
<a class="sourceLine" id="cb43-58" data-line-number="58"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb43-59" data-line-number="59"><span class="co">#&gt; Took 6.0656 seconds.</span></a>
<a class="sourceLine" id="cb43-60" data-line-number="60"><span class="co">#&gt; * Calculating likelihood ratio statistics..</span></a>
<a class="sourceLine" id="cb43-61" data-line-number="61"><span class="co">#&gt; Took 0.0031 seconds.</span></a>
<a class="sourceLine" id="cb43-62" data-line-number="62"><span class="co">#&gt; * Fitting the BB model..</span></a>
<a class="sourceLine" id="cb43-63" data-line-number="63"><span class="co">#&gt;    Using the one way approach.</span></a>
<a class="sourceLine" id="cb43-64" data-line-number="64"><span class="co">#&gt; Took 3.0425 seconds.</span></a>
<a class="sourceLine" id="cb43-65" data-line-number="65"><span class="co">#&gt; * Calculating likelihood ratio statistics..</span></a>
<a class="sourceLine" id="cb43-66" data-line-number="66"><span class="co">#&gt; Took 0.0136 seconds.</span></a></code></pre></div>
<p>With this <code>DTUrtle</code> object we can proceed in the standard way, i.e. with <code><a href="../reference/posthoc_and_stager.html">posthoc_and_stager()</a></code> and following visualization.</p>
<div class="sourceCode" id="cb44"><pre class="downlit">
<span class="va">dturtle_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posthoc_and_stager.html">posthoc_and_stager</a></span><span class="op">(</span>dturtle <span class="op">=</span> <span class="va">dturtle_sub</span>, ofdr <span class="op">=</span> <span class="fl">0.05</span>, posthoc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co">#&gt; Posthoc filtered 33200 features.</span>
<span class="co">#&gt; The returned adjusted p-values are based on a stage-wise testing approach and are only valid for the provided target OFDR level of 5%. If a different target OFDR level is of interest,the entire adjustment should be re-run.</span>
<span class="co">#&gt; Found 4 significant genes with 2 significant transcripts (OFDR: 0.05)</span></pre></div>
<hr>
</div>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<pre><code>#&gt; R version 3.6.2 (2019-12-12)
#&gt; Platform: x86_64-pc-linux-gnu (64-bit)
#&gt; Running under: Debian GNU/Linux 10 (buster)
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.3.5.so
#&gt; 
#&gt; locale:
#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] Seurat_3.2.2  DTUrtle_0.7.1
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;   [1] reticulate_1.16             tidyselect_1.1.0           
#&gt;   [3] RSQLite_2.2.1               AnnotationDbi_1.48.0       
#&gt;   [5] htmlwidgets_1.5.2           grid_3.6.2                 
#&gt;   [7] BiocParallel_1.22.0         Rtsne_0.15                 
#&gt;   [9] munsell_0.5.0               codetools_0.2-16           
#&gt;  [11] ragg_0.4.0                  ica_1.0-2                  
#&gt;  [13] DT_0.16                     future_1.19.1              
#&gt;  [15] miniUI_0.1.1.1              colorspace_1.4-1           
#&gt;  [17] Biobase_2.46.0              sparseDRIMSeq_0.1.2        
#&gt;  [19] knitr_1.30                  rstudioapi_0.11            
#&gt;  [21] stats4_3.6.2                ROCR_1.0-11                
#&gt;  [23] tensor_1.5                  listenv_0.8.0              
#&gt;  [25] labeling_0.4.2              tximport_1.16.1            
#&gt;  [27] GenomeInfoDbData_1.2.2      polyclip_1.10-0            
#&gt;  [29] bit64_4.0.5                 farver_2.0.3               
#&gt;  [31] pheatmap_1.0.12             rprojroot_1.3-2            
#&gt;  [33] Matrix.utils_0.9.8          vctrs_0.3.4                
#&gt;  [35] generics_0.0.2              xfun_0.18                  
#&gt;  [37] biovizBase_1.34.1           BiocFileCache_1.10.2       
#&gt;  [39] R6_2.4.1                    GenomeInfoDb_1.22.1        
#&gt;  [41] rsvd_1.0.3                  locfit_1.5-9.4             
#&gt;  [43] AnnotationFilter_1.10.0     bitops_1.0-6               
#&gt;  [45] spatstat.utils_1.17-0       DelayedArray_0.12.3        
#&gt;  [47] assertthat_0.2.1            promises_1.1.1             
#&gt;  [49] scales_1.1.1                nnet_7.3-12                
#&gt;  [51] gtable_0.3.0                globals_0.13.1             
#&gt;  [53] goftest_1.2-2               ensembldb_2.10.2           
#&gt;  [55] rlang_0.4.8                 systemfonts_0.3.2          
#&gt;  [57] splines_3.6.2               rtracklayer_1.46.0         
#&gt;  [59] lazyeval_0.2.2              dichromat_2.0-0            
#&gt;  [61] checkmate_2.0.0             formattable_0.2.0.1        
#&gt;  [63] abind_1.4-5                 yaml_2.2.1                 
#&gt;  [65] reshape2_1.4.4              GenomicFeatures_1.38.2     
#&gt;  [67] crosstalk_1.1.0.1           backports_1.1.10           
#&gt;  [69] httpuv_1.5.4                Hmisc_4.4-1                
#&gt;  [71] tools_3.6.2                 ggplot2_3.3.2              
#&gt;  [73] ellipsis_0.3.1              RColorBrewer_1.1-2         
#&gt;  [75] BiocGenerics_0.32.0         ggridges_0.5.2             
#&gt;  [77] Rcpp_1.0.5                  plyr_1.8.6                 
#&gt;  [79] base64enc_0.1-3             progress_1.2.2             
#&gt;  [81] zlibbioc_1.32.0             purrr_0.3.4                
#&gt;  [83] RCurl_1.98-1.2              prettyunits_1.1.1          
#&gt;  [85] deldir_0.1-29               rpart_4.1-15               
#&gt;  [87] openssl_1.4.3               pbapply_1.4-3              
#&gt;  [89] cowplot_1.1.0               S4Vectors_0.24.4           
#&gt;  [91] zoo_1.8-8                   SummarizedExperiment_1.16.1
#&gt;  [93] grr_0.9.5                   ggrepel_0.8.2              
#&gt;  [95] cluster_2.1.0               fs_1.5.0                   
#&gt;  [97] magrittr_1.5                data.table_1.13.2          
#&gt;  [99] lmtest_0.9-38               RANN_2.6.1                 
#&gt; [101] ProtGenerics_1.18.0         fitdistrplus_1.1-1         
#&gt; [103] matrixStats_0.57.0          hms_0.5.3                  
#&gt; [105] patchwork_1.0.1             mime_0.9                   
#&gt; [107] evaluate_0.14               xtable_1.8-4               
#&gt; [109] XML_3.99-0.3                jpeg_0.1-8.1               
#&gt; [111] IRanges_2.20.2              gridExtra_2.3              
#&gt; [113] compiler_3.6.2              biomaRt_2.42.1             
#&gt; [115] tibble_3.0.4                KernSmooth_2.23-16         
#&gt; [117] crayon_1.3.4                htmltools_0.5.0            
#&gt; [119] mgcv_1.8-31                 later_1.1.0.1              
#&gt; [121] Formula_1.2-4               tidyr_1.1.2                
#&gt; [123] DBI_1.1.0                   dbplyr_1.4.4               
#&gt; [125] MASS_7.3-51.4               rappdirs_0.3.1             
#&gt; [127] Matrix_1.2-18               parallel_3.6.2             
#&gt; [129] Gviz_1.30.4                 igraph_1.2.6               
#&gt; [131] GenomicRanges_1.38.0        pkgconfig_2.0.3            
#&gt; [133] pkgdown_1.6.1               GenomicAlignments_1.22.1   
#&gt; [135] foreign_0.8-72              plotly_4.9.2.1             
#&gt; [137] XVector_0.26.0              stringr_1.4.0              
#&gt; [139] VariantAnnotation_1.32.0    digest_0.6.26              
#&gt; [141] sctransform_0.3.1           RcppAnnoy_0.0.16           
#&gt; [143] spatstat.data_1.4-3         Biostrings_2.54.0          
#&gt; [145] rmarkdown_2.5               leiden_0.3.3               
#&gt; [147] htmlTable_2.1.0             uwot_0.1.8                 
#&gt; [149] edgeR_3.28.1                curl_4.3                   
#&gt; [151] shiny_1.5.0                 Rsamtools_2.2.3            
#&gt; [153] nlme_3.1-142                lifecycle_0.2.0            
#&gt; [155] jsonlite_1.7.1              stageR_1.10.0              
#&gt; [157] desc_1.2.0                  viridisLite_0.3.0          
#&gt; [159] askpass_1.1                 limma_3.42.2               
#&gt; [161] BSgenome_1.54.0             pillar_1.4.6               
#&gt; [163] lattice_0.20-38             fastmap_1.0.1              
#&gt; [165] httr_1.4.2                  survival_3.1-8             
#&gt; [167] glue_1.4.2                  spatstat_1.64-1            
#&gt; [169] png_0.1-7                   bit_4.0.4                  
#&gt; [171] stringi_1.5.3               blob_1.2.1                 
#&gt; [173] textshaping_0.1.2           latticeExtra_0.6-29        
#&gt; [175] memoise_1.1.0               dplyr_1.0.2                
#&gt; [177] irlba_2.3.3                 future.apply_1.6.0</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tobias Tekath.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'a6c9f43b010fdd4b2e64792389fd67d2',
    indexName: 'dturtle',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
